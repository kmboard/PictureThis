{"ast":null,"code":"/*!\n * FilePondPluginImagePreview 4.6.11\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = global || self, global.FilePondPluginImagePreview = factory());\n})(this, function () {\n  'use strict'; // test if file is of type image and can be viewed in canvas\n\n  var isPreviewableImage = function isPreviewableImage(file) {\n    return /^image/.test(file.type);\n  };\n\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var REACT_ELEMENT_TYPE;\n\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE = typeof Symbol === 'function' && Symbol.for && Symbol.for('react.element') || 0xeac7;\n    }\n\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n\n  function _asyncIterator(iterable) {\n    var method;\n\n    if (typeof Symbol === 'function') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n\n    throw new TypeError('Object is not async iterable');\n  }\n\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n\n  function _AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function (resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(function (arg) {\n          if (wrappedAwait) {\n            resume('next', arg);\n            return;\n          }\n\n          settle(result.done ? 'return' : 'normal', arg);\n        }, function (err) {\n          resume('throw', err);\n        });\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case 'throw':\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function () {\n      return this;\n    };\n  }\n\n  _AsyncGenerator.prototype.next = function (arg) {\n    return this._invoke('next', arg);\n  };\n\n  _AsyncGenerator.prototype.throw = function (arg) {\n    return this._invoke('throw', arg);\n  };\n\n  _AsyncGenerator.prototype.return = function (arg) {\n    return this._invoke('return', arg);\n  };\n\n  function _wrapAsyncGenerator(fn) {\n    return function () {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n        waiting = false;\n\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function (resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function () {\n        return this;\n      };\n    }\n\n    iter.next = function (value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n\n      return pump('next', value);\n    };\n\n    if (typeof inner.throw === 'function') {\n      iter.throw = function (value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n\n        return pump('throw', value);\n      };\n    }\n\n    if (typeof inner.return === 'function') {\n      iter.return = function (value) {\n        return pump('return', value);\n      };\n    }\n\n    return iter;\n  }\n\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n\n  function _asyncToGenerator(fn) {\n    return function () {\n      var self = this,\n          args = arguments;\n      return new Promise(function (resolve, reject) {\n        var gen = fn.apply(self, args);\n\n        function _next(value) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n        }\n\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n\n        _next(undefined);\n      });\n    };\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _extends() {\n    _extends = Object.assign || function (target) {\n      for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i];\n\n        for (var key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n\n      return target;\n    };\n\n    return _extends.apply(this, arguments);\n  }\n\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n          return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n        }));\n      }\n\n      ownKeys.forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n\n    return target;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n\n    return _construct.apply(null, arguments);\n  }\n\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n\n      if (typeof Class !== 'function') {\n        throw new TypeError('Super expression must either be null or a function');\n      }\n\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n\n        _cache.set(Class, Wrapper);\n      }\n\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n\n    return _wrapNativeSuper(Class);\n  }\n\n  function _instanceof(left, right) {\n    if (right != null && typeof Symbol !== 'undefined' && right[Symbol.hasInstance]) {\n      return right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n\n        var desc;\n\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n\n        return true;\n      };\n    }\n\n    return set(target, property, value, receiver);\n  }\n\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n\n    return value;\n  }\n\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    return Object.freeze(Object.defineProperties(strings, {\n      raw: {\n        value: Object.freeze(raw)\n      }\n    }));\n  }\n\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    strings.raw = raw;\n    return strings;\n  }\n\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n\n  function _classNameTDZError(name) {\n    throw new Error('Class \"' + name + '\" cannot be referenced in computed property keys.');\n  }\n\n  var _temporalUndefined = {};\n\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n  }\n\n  function _slicedToArrayLoose(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();\n  }\n\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === '[object Arguments]') return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n\n    for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n\n  function _skipFirstGeneratorNext(fn) {\n    return function () {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n\n    return (hint === 'string' ? String : Number)(input);\n  }\n\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n\n    return typeof key === 'symbol' ? key : String(key);\n  }\n\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and set to use loose mode. ' + 'To use proposal-class-properties in spec mode with decorators, wait for ' + 'the next major version of decorators in stage 2.');\n  }\n\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer ? descriptor.initializer.call(context) : void 0\n    });\n  }\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function (key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n\n    desc = decorators.slice().reverse().reduce(function (desc, decorator) {\n      return decorator(target, property, desc) || desc;\n    }, desc);\n\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n\n    return desc;\n  }\n\n  var id = 0;\n\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n\n    return receiver;\n  }\n\n  function _classPrivateFieldGet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n\n    return descriptor.value;\n  }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      descriptor.value = value;\n    }\n\n    return value;\n  }\n\n  function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return descriptor.value;\n  }\n\n  function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n\n    descriptor.value = value;\n    return value;\n  }\n\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return method;\n  }\n\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(_coalesceClassElements(r.d.map(_createElementDescriptor)), decorators);\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function () {\n      return api;\n    };\n\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function (O, elements) {\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function (F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            var placement = element.placement;\n\n            if (element.kind === kind && (placement === 'static' || placement === 'prototype')) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function (receiver, element) {\n        var descriptor = element.descriptor;\n\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function (elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function (element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function (element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(element, placements);\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function (element, placements, silent) {\n        var keys = placements[element.placement];\n\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n\n        keys.push(element.key);\n      },\n      decorateElement: function (element, placements) {\n        var extras = [];\n        var finishers = [];\n\n        for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras((0, decorators[i])(elementObject) || elementObject);\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n\n          var newExtras = elementFinisherExtras.extras;\n\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n\n            extras.push.apply(extras, newExtras);\n          }\n        }\n\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function (elements, decorators) {\n        var finishers = [];\n\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor((0, decorators[i])(obj) || obj);\n\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (elements[j].key === elements[k].key && elements[j].placement === elements[k].placement) {\n                  throw new TypeError('Duplicated element (' + elements[j].key + ')');\n                }\n              }\n            }\n          }\n        }\n\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function (element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function (elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function (elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(elementObject, 'finisher', 'An element descriptor');\n          this.disallowProperty(elementObject, 'extras', 'An element descriptor');\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function (elementObject) {\n        var kind = String(elementObject.kind);\n\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError('An element descriptor\\'s .kind property must be either \"method\" or' + ' \"field\", but a decorator created an element descriptor with' + ' .kind \"' + kind + '\"');\n        }\n\n        var key = _toPropertyKey(elementObject.key);\n\n        var placement = String(elementObject.placement);\n\n        if (placement !== 'static' && placement !== 'prototype' && placement !== 'own') {\n          throw new TypeError('An element descriptor\\'s .placement property must be one of \"static\",' + ' \"prototype\" or \"own\", but a decorator created an element descriptor' + ' with .placement \"' + placement + '\"');\n        }\n\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(elementObject, 'elements', 'An element descriptor');\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n\n        if (kind !== 'field') {\n          this.disallowProperty(elementObject, 'initializer', 'A method descriptor');\n        } else {\n          this.disallowProperty(descriptor, 'get', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'set', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'value', 'The property descriptor of a field descriptor');\n          element.initializer = elementObject.initializer;\n        }\n\n        return element;\n      },\n      toElementFinisherExtras: function (elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function (elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function (obj) {\n        var kind = String(obj.kind);\n\n        if (kind !== 'class') {\n          throw new TypeError('A class descriptor\\'s .kind property must be \"class\", but a decorator' + ' created a class descriptor with .kind \"' + kind + '\"');\n        }\n\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function (constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n\n            constructor = newConstructor;\n          }\n        }\n\n        return constructor;\n      },\n      disallowProperty: function (obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(objectType + \" can't have a .\" + name + ' property.');\n        }\n      }\n    };\n    return api;\n  }\n\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n\n    var descriptor;\n\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static ? 'static' : def.kind === 'field' ? 'own' : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n\n    var isSameElement = function (other) {\n      return other.kind === 'method' && other.key === element.key && other.placement === element.placement;\n    };\n\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n\n      if (element.kind === 'method' && (other = newElements.find(isSameElement))) {\n        if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError('Duplicated methods (' + element.key + \") can't be decorated.\");\n          }\n\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\"Decorators can't be placed on different accessors with for \" + 'the same property (' + element.key + ').');\n            }\n\n            other.decorators = element.decorators;\n          }\n\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n\n    return newElements;\n  }\n\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n\n  function _isDataDescriptor(desc) {\n    return desc !== undefined && !(desc.value === undefined && desc.writable === undefined);\n  }\n\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n\n    return value;\n  }\n\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    return fn;\n  }\n\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function (re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n\n    var _RegExp = _wrapNativeSuper(RegExp);\n\n    var _super = RegExp.prototype;\n\n    var _groups = new WeakMap();\n\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n\n      _groups.set(_this, groups);\n\n      return _this;\n    }\n\n    _inherits(BabelRegExp, _RegExp);\n\n    BabelRegExp.prototype.exec = function (str) {\n      var result = _super.exec.call(this, str);\n\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n\n    BabelRegExp.prototype[Symbol.replace] = function (str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n\n        return _super[Symbol.replace].call(this, str, substitution.replace(/\\$<([^>]+)>/g, function (_, name) {\n          return '$' + groups[name];\n        }));\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n\n        return _super[Symbol.replace].call(this, str, function () {\n          var args = [];\n          args.push.apply(args, arguments);\n\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n\n      return Object.keys(g).reduce(function (groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n\n    return _wrapRegExp.apply(this, arguments);\n  }\n\n  var vectorMultiply = function vectorMultiply(v, amount) {\n    return createVector(v.x * amount, v.y * amount);\n  };\n\n  var vectorAdd = function vectorAdd(a, b) {\n    return createVector(a.x + b.x, a.y + b.y);\n  };\n\n  var vectorNormalize = function vectorNormalize(v) {\n    var l = Math.sqrt(v.x * v.x + v.y * v.y);\n\n    if (l === 0) {\n      return {\n        x: 0,\n        y: 0\n      };\n    }\n\n    return createVector(v.x / l, v.y / l);\n  };\n\n  var vectorRotate = function vectorRotate(v, radians, origin) {\n    var cos = Math.cos(radians);\n    var sin = Math.sin(radians);\n    var t = createVector(v.x - origin.x, v.y - origin.y);\n    return createVector(origin.x + cos * t.x - sin * t.y, origin.y + sin * t.x + cos * t.y);\n  };\n\n  var createVector = function createVector() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var getMarkupValue = function getMarkupValue(value, size) {\n    var scalar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var axis = arguments.length > 3 ? arguments[3] : undefined;\n\n    if (typeof value === 'string') {\n      return parseFloat(value) * scalar;\n    }\n\n    if (typeof value === 'number') {\n      return value * (axis ? size[axis] : Math.min(size.width, size.height));\n    }\n\n    return;\n  };\n\n  var getMarkupStyles = function getMarkupStyles(markup, size, scale) {\n    var lineStyle = markup.borderStyle || markup.lineStyle || 'solid';\n    var fill = markup.backgroundColor || markup.fontColor || 'transparent';\n    var stroke = markup.borderColor || markup.lineColor || 'transparent';\n    var strokeWidth = getMarkupValue(markup.borderWidth || markup.lineWidth, size, scale);\n    var lineCap = markup.lineCap || 'round';\n    var lineJoin = markup.lineJoin || 'round';\n    var dashes = typeof lineStyle === 'string' ? '' : lineStyle.map(function (v) {\n      return getMarkupValue(v, size, scale);\n    }).join(',');\n    var opacity = markup.opacity || 1;\n    return {\n      'stroke-linecap': lineCap,\n      'stroke-linejoin': lineJoin,\n      'stroke-width': strokeWidth || 0,\n      'stroke-dasharray': dashes,\n      stroke: stroke,\n      fill: fill,\n      opacity: opacity\n    };\n  };\n\n  var isDefined = function isDefined(value) {\n    return value != null;\n  };\n\n  var getMarkupRect = function getMarkupRect(rect, size) {\n    var scalar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var left = getMarkupValue(rect.x, size, scalar, 'width') || getMarkupValue(rect.left, size, scalar, 'width');\n    var top = getMarkupValue(rect.y, size, scalar, 'height') || getMarkupValue(rect.top, size, scalar, 'height');\n    var width = getMarkupValue(rect.width, size, scalar, 'width');\n    var height = getMarkupValue(rect.height, size, scalar, 'height');\n    var right = getMarkupValue(rect.right, size, scalar, 'width');\n    var bottom = getMarkupValue(rect.bottom, size, scalar, 'height');\n\n    if (!isDefined(top)) {\n      if (isDefined(height) && isDefined(bottom)) {\n        top = size.height - height - bottom;\n      } else {\n        top = bottom;\n      }\n    }\n\n    if (!isDefined(left)) {\n      if (isDefined(width) && isDefined(right)) {\n        left = size.width - width - right;\n      } else {\n        left = right;\n      }\n    }\n\n    if (!isDefined(width)) {\n      if (isDefined(left) && isDefined(right)) {\n        width = size.width - left - right;\n      } else {\n        width = 0;\n      }\n    }\n\n    if (!isDefined(height)) {\n      if (isDefined(top) && isDefined(bottom)) {\n        height = size.height - top - bottom;\n      } else {\n        height = 0;\n      }\n    }\n\n    return {\n      x: left || 0,\n      y: top || 0,\n      width: width || 0,\n      height: height || 0\n    };\n  };\n\n  var pointsToPathShape = function pointsToPathShape(points) {\n    return points.map(function (point, index) {\n      return ''.concat(index === 0 ? 'M' : 'L', ' ').concat(point.x, ' ').concat(point.y);\n    }).join(' ');\n  };\n\n  var setAttributes = function setAttributes(element, attr) {\n    return Object.keys(attr).forEach(function (key) {\n      return element.setAttribute(key, attr[key]);\n    });\n  };\n\n  var ns = 'http://www.w3.org/2000/svg';\n\n  var svg = function svg(tag, attr) {\n    var element = document.createElementNS(ns, tag);\n\n    if (attr) {\n      setAttributes(element, attr);\n    }\n\n    return element;\n  };\n\n  var updateRect = function updateRect(element) {\n    return setAttributes(element, Object.assign({}, element.rect, element.styles));\n  };\n\n  var updateEllipse = function updateEllipse(element) {\n    var cx = element.rect.x + element.rect.width * 0.5;\n    var cy = element.rect.y + element.rect.height * 0.5;\n    var rx = element.rect.width * 0.5;\n    var ry = element.rect.height * 0.5;\n    return setAttributes(element, Object.assign({\n      cx: cx,\n      cy: cy,\n      rx: rx,\n      ry: ry\n    }, element.styles));\n  };\n\n  var IMAGE_FIT_STYLE = {\n    contain: 'xMidYMid meet',\n    cover: 'xMidYMid slice'\n  };\n\n  var updateImage = function updateImage(element, markup) {\n    setAttributes(element, Object.assign({}, element.rect, element.styles, {\n      preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || 'none'\n    }));\n  };\n\n  var TEXT_ANCHOR = {\n    left: 'start',\n    center: 'middle',\n    right: 'end'\n  };\n\n  var updateText = function updateText(element, markup, size, scale) {\n    var fontSize = getMarkupValue(markup.fontSize, size, scale);\n    var fontFamily = markup.fontFamily || 'sans-serif';\n    var fontWeight = markup.fontWeight || 'normal';\n    var textAlign = TEXT_ANCHOR[markup.textAlign] || 'start';\n    setAttributes(element, Object.assign({}, element.rect, element.styles, {\n      'stroke-width': 0,\n      'font-weight': fontWeight,\n      'font-size': fontSize,\n      'font-family': fontFamily,\n      'text-anchor': textAlign\n    })); // update text\n\n    if (element.text !== markup.text) {\n      element.text = markup.text;\n      element.textContent = markup.text.length ? markup.text : ' ';\n    }\n  };\n\n  var updateLine = function updateLine(element, markup, size, scale) {\n    setAttributes(element, Object.assign({}, element.rect, element.styles, {\n      fill: 'none'\n    }));\n    var line = element.childNodes[0];\n    var begin = element.childNodes[1];\n    var end = element.childNodes[2];\n    var origin = element.rect;\n    var target = {\n      x: element.rect.x + element.rect.width,\n      y: element.rect.y + element.rect.height\n    };\n    setAttributes(line, {\n      x1: origin.x,\n      y1: origin.y,\n      x2: target.x,\n      y2: target.y\n    });\n    if (!markup.lineDecoration) return;\n    begin.style.display = 'none';\n    end.style.display = 'none';\n    var v = vectorNormalize({\n      x: target.x - origin.x,\n      y: target.y - origin.y\n    });\n    var l = getMarkupValue(0.05, size, scale);\n\n    if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n      var arrowBeginRotationPoint = vectorMultiply(v, l);\n      var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n      var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n      var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n      setAttributes(begin, {\n        style: 'display:block;',\n        d: 'M'.concat(arrowBeginA.x, ',').concat(arrowBeginA.y, ' L').concat(origin.x, ',').concat(origin.y, ' L').concat(arrowBeginB.x, ',').concat(arrowBeginB.y)\n      });\n    }\n\n    if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n      var arrowEndRotationPoint = vectorMultiply(v, -l);\n      var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n      var arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n      var arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n      setAttributes(end, {\n        style: 'display:block;',\n        d: 'M'.concat(arrowEndA.x, ',').concat(arrowEndA.y, ' L').concat(target.x, ',').concat(target.y, ' L').concat(arrowEndB.x, ',').concat(arrowEndB.y)\n      });\n    }\n  };\n\n  var updatePath = function updatePath(element, markup, size, scale) {\n    setAttributes(element, Object.assign({}, element.styles, {\n      fill: 'none',\n      d: pointsToPathShape(markup.points.map(function (point) {\n        return {\n          x: getMarkupValue(point.x, size, scale, 'width'),\n          y: getMarkupValue(point.y, size, scale, 'height')\n        };\n      }))\n    }));\n  };\n\n  var createShape = function createShape(node) {\n    return function (markup) {\n      return svg(node, {\n        id: markup.id\n      });\n    };\n  };\n\n  var createImage = function createImage(markup) {\n    var shape = svg('image', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round',\n      opacity: '0'\n    });\n\n    shape.onload = function () {\n      shape.setAttribute('opacity', markup.opacity || 1);\n    };\n\n    shape.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', markup.src);\n    return shape;\n  };\n\n  var createLine = function createLine(markup) {\n    var shape = svg('g', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round'\n    });\n    var line = svg('line');\n    shape.appendChild(line);\n    var begin = svg('path');\n    shape.appendChild(begin);\n    var end = svg('path');\n    shape.appendChild(end);\n    return shape;\n  };\n\n  var CREATE_TYPE_ROUTES = {\n    image: createImage,\n    rect: createShape('rect'),\n    ellipse: createShape('ellipse'),\n    text: createShape('text'),\n    path: createShape('path'),\n    line: createLine\n  };\n  var UPDATE_TYPE_ROUTES = {\n    rect: updateRect,\n    ellipse: updateEllipse,\n    image: updateImage,\n    text: updateText,\n    path: updatePath,\n    line: updateLine\n  };\n\n  var createMarkupByType = function createMarkupByType(type, markup) {\n    return CREATE_TYPE_ROUTES[type](markup);\n  };\n\n  var updateMarkupByType = function updateMarkupByType(element, type, markup, size, scale) {\n    if (type !== 'path') {\n      element.rect = getMarkupRect(markup, size, scale);\n    }\n\n    element.styles = getMarkupStyles(markup, size, scale);\n    UPDATE_TYPE_ROUTES[type](element, markup, size, scale);\n  };\n\n  var MARKUP_RECT = ['x', 'y', 'left', 'top', 'right', 'bottom', 'width', 'height'];\n\n  var toOptionalFraction = function toOptionalFraction(value) {\n    return typeof value === 'string' && /%/.test(value) ? parseFloat(value) / 100 : value;\n  }; // adds default markup properties, clones markup\n\n\n  var prepareMarkup = function prepareMarkup(markup) {\n    var _markup = _slicedToArray(markup, 2),\n        type = _markup[0],\n        props = _markup[1];\n\n    var rect = props.points ? {} : MARKUP_RECT.reduce(function (prev, curr) {\n      prev[curr] = toOptionalFraction(props[curr]);\n      return prev;\n    }, {});\n    return [type, Object.assign({\n      zIndex: 0\n    }, props, rect)];\n  };\n\n  var sortMarkupByZIndex = function sortMarkupByZIndex(a, b) {\n    if (a[1].zIndex > b[1].zIndex) {\n      return 1;\n    }\n\n    if (a[1].zIndex < b[1].zIndex) {\n      return -1;\n    }\n\n    return 0;\n  };\n\n  var createMarkupView = function createMarkupView(_) {\n    return _.utils.createView({\n      name: 'image-preview-markup',\n      tag: 'svg',\n      ignoreRect: true,\n      mixins: {\n        apis: ['width', 'height', 'crop', 'markup', 'resize', 'dirty']\n      },\n      write: function write(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n        if (!props.dirty) return;\n        var crop = props.crop,\n            resize = props.resize,\n            markup = props.markup;\n        var viewWidth = props.width;\n        var viewHeight = props.height;\n        var cropWidth = crop.width;\n        var cropHeight = crop.height;\n\n        if (resize) {\n          var _size = resize.size;\n          var outputWidth = _size && _size.width;\n          var outputHeight = _size && _size.height;\n          var outputFit = resize.mode;\n          var outputUpscale = resize.upscale;\n          if (outputWidth && !outputHeight) outputHeight = outputWidth;\n          if (outputHeight && !outputWidth) outputWidth = outputHeight;\n          var shouldUpscale = cropWidth < outputWidth && cropHeight < outputHeight;\n\n          if (!shouldUpscale || shouldUpscale && outputUpscale) {\n            var scalarWidth = outputWidth / cropWidth;\n            var scalarHeight = outputHeight / cropHeight;\n\n            if (outputFit === 'force') {\n              cropWidth = outputWidth;\n              cropHeight = outputHeight;\n            } else {\n              var scalar;\n\n              if (outputFit === 'cover') {\n                scalar = Math.max(scalarWidth, scalarHeight);\n              } else if (outputFit === 'contain') {\n                scalar = Math.min(scalarWidth, scalarHeight);\n              }\n\n              cropWidth = cropWidth * scalar;\n              cropHeight = cropHeight * scalar;\n            }\n          }\n        }\n\n        var size = {\n          width: viewWidth,\n          height: viewHeight\n        };\n        root.element.setAttribute('width', size.width);\n        root.element.setAttribute('height', size.height);\n        var scale = Math.min(viewWidth / cropWidth, viewHeight / cropHeight); // clear\n\n        root.element.innerHTML = ''; // get filter\n\n        var markupFilter = root.query('GET_IMAGE_PREVIEW_MARKUP_FILTER'); // draw new\n\n        markup.filter(markupFilter).map(prepareMarkup).sort(sortMarkupByZIndex).forEach(function (markup) {\n          var _markup = _slicedToArray(markup, 2),\n              type = _markup[0],\n              settings = _markup[1]; // create\n\n\n          var element = createMarkupByType(type, settings); // update\n\n          updateMarkupByType(element, type, settings, size, scale); // add\n\n          root.element.appendChild(element);\n        });\n      }\n    });\n  };\n\n  var createVector$1 = function createVector(x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var vectorDot = function vectorDot(a, b) {\n    return a.x * b.x + a.y * b.y;\n  };\n\n  var vectorSubtract = function vectorSubtract(a, b) {\n    return createVector$1(a.x - b.x, a.y - b.y);\n  };\n\n  var vectorDistanceSquared = function vectorDistanceSquared(a, b) {\n    return vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));\n  };\n\n  var vectorDistance = function vectorDistance(a, b) {\n    return Math.sqrt(vectorDistanceSquared(a, b));\n  };\n\n  var getOffsetPointOnEdge = function getOffsetPointOnEdge(length, rotation) {\n    var a = length;\n    var A = 1.5707963267948966;\n    var B = rotation;\n    var C = 1.5707963267948966 - rotation;\n    var sinA = Math.sin(A);\n    var sinB = Math.sin(B);\n    var sinC = Math.sin(C);\n    var cosC = Math.cos(C);\n    var ratio = a / sinA;\n    var b = ratio * sinB;\n    var c = ratio * sinC;\n    return createVector$1(cosC * b, cosC * c);\n  };\n\n  var getRotatedRectSize = function getRotatedRectSize(rect, rotation) {\n    var w = rect.width;\n    var h = rect.height;\n    var hor = getOffsetPointOnEdge(w, rotation);\n    var ver = getOffsetPointOnEdge(h, rotation);\n    var tl = createVector$1(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));\n    var tr = createVector$1(rect.x + rect.width + Math.abs(ver.y), rect.y + Math.abs(ver.x));\n    var bl = createVector$1(rect.x - Math.abs(ver.y), rect.y + rect.height - Math.abs(ver.x));\n    return {\n      width: vectorDistance(tl, tr),\n      height: vectorDistance(tl, bl)\n    };\n  };\n\n  var calculateCanvasSize = function calculateCanvasSize(image, canvasAspectRatio) {\n    var zoom = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var imageAspectRatio = image.height / image.width; // determine actual pixels on x and y axis\n\n    var canvasWidth = 1;\n    var canvasHeight = canvasAspectRatio;\n    var imgWidth = 1;\n    var imgHeight = imageAspectRatio;\n\n    if (imgHeight > canvasHeight) {\n      imgHeight = canvasHeight;\n      imgWidth = imgHeight / imageAspectRatio;\n    }\n\n    var scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);\n    var width = image.width / (zoom * scalar * imgWidth);\n    var height = width * canvasAspectRatio;\n    return {\n      width: width,\n      height: height\n    };\n  };\n\n  var getImageRectZoomFactor = function getImageRectZoomFactor(imageRect, cropRect, rotation, center) {\n    // calculate available space round image center position\n    var cx = center.x > 0.5 ? 1 - center.x : center.x;\n    var cy = center.y > 0.5 ? 1 - center.y : center.y;\n    var imageWidth = cx * 2 * imageRect.width;\n    var imageHeight = cy * 2 * imageRect.height; // calculate rotated crop rectangle size\n\n    var rotatedCropSize = getRotatedRectSize(cropRect, rotation); // calculate scalar required to fit image\n\n    return Math.max(rotatedCropSize.width / imageWidth, rotatedCropSize.height / imageHeight);\n  };\n\n  var getCenteredCropRect = function getCenteredCropRect(container, aspectRatio) {\n    var width = container.width;\n    var height = width * aspectRatio;\n\n    if (height > container.height) {\n      height = container.height;\n      width = height / aspectRatio;\n    }\n\n    var x = (container.width - width) * 0.5;\n    var y = (container.height - height) * 0.5;\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  };\n\n  var getCurrentCropSize = function getCurrentCropSize(imageSize) {\n    var crop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var zoom = crop.zoom,\n        rotation = crop.rotation,\n        center = crop.center,\n        aspectRatio = crop.aspectRatio;\n    if (!aspectRatio) aspectRatio = imageSize.height / imageSize.width;\n    var canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n    var canvasCenter = {\n      x: canvasSize.width * 0.5,\n      y: canvasSize.height * 0.5\n    };\n    var stage = {\n      x: 0,\n      y: 0,\n      width: canvasSize.width,\n      height: canvasSize.height,\n      center: canvasCenter\n    };\n    var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n    var stageZoomFactor = getImageRectZoomFactor(imageSize, getCenteredCropRect(stage, aspectRatio), rotation, shouldLimit ? center : {\n      x: 0.5,\n      y: 0.5\n    });\n    var scale = zoom * stageZoomFactor; // start drawing\n\n    return {\n      widthFloat: canvasSize.width / scale,\n      heightFloat: canvasSize.height / scale,\n      width: Math.round(canvasSize.width / scale),\n      height: Math.round(canvasSize.height / scale)\n    };\n  };\n\n  var IMAGE_SCALE_SPRING_PROPS = {\n    type: 'spring',\n    stiffness: 0.5,\n    damping: 0.45,\n    mass: 10\n  }; // does horizontal and vertical flipping\n\n  var createBitmapView = function createBitmapView(_) {\n    return _.utils.createView({\n      name: 'image-bitmap',\n      ignoreRect: true,\n      mixins: {\n        styles: ['scaleX', 'scaleY']\n      },\n      create: function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n        root.appendChild(props.image);\n      }\n    });\n  }; // shifts and rotates image\n\n\n  var createImageCanvasWrapper = function createImageCanvasWrapper(_) {\n    return _.utils.createView({\n      name: 'image-canvas-wrapper',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['crop', 'width', 'height'],\n        styles: ['originX', 'originY', 'translateX', 'translateY', 'scaleX', 'scaleY', 'rotateZ'],\n        animations: {\n          originX: IMAGE_SCALE_SPRING_PROPS,\n          originY: IMAGE_SCALE_SPRING_PROPS,\n          scaleX: IMAGE_SCALE_SPRING_PROPS,\n          scaleY: IMAGE_SCALE_SPRING_PROPS,\n          translateX: IMAGE_SCALE_SPRING_PROPS,\n          translateY: IMAGE_SCALE_SPRING_PROPS,\n          rotateZ: IMAGE_SCALE_SPRING_PROPS\n        }\n      },\n      create: function create(_ref2) {\n        var root = _ref2.root,\n            props = _ref2.props;\n        props.width = props.image.width;\n        props.height = props.image.height;\n        root.ref.bitmap = root.appendChildView(root.createChildView(createBitmapView(_), {\n          image: props.image\n        }));\n      },\n      write: function write(_ref3) {\n        var root = _ref3.root,\n            props = _ref3.props;\n        var flip = props.crop.flip;\n        var bitmap = root.ref.bitmap;\n        bitmap.scaleX = flip.horizontal ? -1 : 1;\n        bitmap.scaleY = flip.vertical ? -1 : 1;\n      }\n    });\n  }; // clips canvas to correct aspect ratio\n\n\n  var createClipView = function createClipView(_) {\n    return _.utils.createView({\n      name: 'image-clip',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['crop', 'markup', 'resize', 'width', 'height', 'dirty', 'background'],\n        styles: ['width', 'height', 'opacity'],\n        animations: {\n          opacity: {\n            type: 'tween',\n            duration: 250\n          }\n        }\n      },\n      didWriteView: function didWriteView(_ref4) {\n        var root = _ref4.root,\n            props = _ref4.props;\n        if (!props.background) return;\n        root.element.style.backgroundColor = props.background;\n      },\n      create: function create(_ref5) {\n        var root = _ref5.root,\n            props = _ref5.props;\n        root.ref.image = root.appendChildView(root.createChildView(createImageCanvasWrapper(_), Object.assign({}, props)));\n\n        root.ref.createMarkup = function () {\n          if (root.ref.markup) return;\n          root.ref.markup = root.appendChildView(root.createChildView(createMarkupView(_), Object.assign({}, props)));\n        };\n\n        root.ref.destroyMarkup = function () {\n          if (!root.ref.markup) return;\n          root.removeChildView(root.ref.markup);\n          root.ref.markup = null;\n        }; // set up transparency grid\n\n\n        var transparencyIndicator = root.query('GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR');\n        if (transparencyIndicator === null) return; // grid pattern\n\n        if (transparencyIndicator === 'grid') {\n          root.element.dataset.transparencyIndicator = transparencyIndicator;\n        } // basic color\n        else {\n          root.element.dataset.transparencyIndicator = 'color';\n        }\n      },\n      write: function write(_ref6) {\n        var root = _ref6.root,\n            props = _ref6.props,\n            shouldOptimize = _ref6.shouldOptimize;\n        var crop = props.crop,\n            markup = props.markup,\n            resize = props.resize,\n            dirty = props.dirty,\n            width = props.width,\n            height = props.height;\n        root.ref.image.crop = crop;\n        var stage = {\n          x: 0,\n          y: 0,\n          width: width,\n          height: height,\n          center: {\n            x: width * 0.5,\n            y: height * 0.5\n          }\n        };\n        var image = {\n          width: root.ref.image.width,\n          height: root.ref.image.height\n        };\n        var origin = {\n          x: crop.center.x * image.width,\n          y: crop.center.y * image.height\n        };\n        var translation = {\n          x: stage.center.x - image.width * crop.center.x,\n          y: stage.center.y - image.height * crop.center.y\n        };\n        var rotation = Math.PI * 2 + crop.rotation % (Math.PI * 2);\n        var cropAspectRatio = crop.aspectRatio || image.height / image.width;\n        var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n        var stageZoomFactor = getImageRectZoomFactor(image, getCenteredCropRect(stage, cropAspectRatio), rotation, shouldLimit ? crop.center : {\n          x: 0.5,\n          y: 0.5\n        });\n        var scale = crop.zoom * stageZoomFactor; // update markup view\n\n        if (markup && markup.length) {\n          root.ref.createMarkup();\n          root.ref.markup.width = width;\n          root.ref.markup.height = height;\n          root.ref.markup.resize = resize;\n          root.ref.markup.dirty = dirty;\n          root.ref.markup.markup = markup;\n          root.ref.markup.crop = getCurrentCropSize(image, crop);\n        } else if (root.ref.markup) {\n          root.ref.destroyMarkup();\n        } // update image view\n\n\n        var imageView = root.ref.image; // don't update clip layout\n\n        if (shouldOptimize) {\n          imageView.originX = null;\n          imageView.originY = null;\n          imageView.translateX = null;\n          imageView.translateY = null;\n          imageView.rotateZ = null;\n          imageView.scaleX = null;\n          imageView.scaleY = null;\n          return;\n        }\n\n        imageView.originX = origin.x;\n        imageView.originY = origin.y;\n        imageView.translateX = translation.x;\n        imageView.translateY = translation.y;\n        imageView.rotateZ = rotation;\n        imageView.scaleX = scale;\n        imageView.scaleY = scale;\n      }\n    });\n  };\n\n  var createImageView = function createImageView(_) {\n    return _.utils.createView({\n      name: 'image-preview',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['image', 'crop', 'markup', 'resize', 'dirty', 'background'],\n        styles: ['translateY', 'scaleX', 'scaleY', 'opacity'],\n        animations: {\n          scaleX: IMAGE_SCALE_SPRING_PROPS,\n          scaleY: IMAGE_SCALE_SPRING_PROPS,\n          translateY: IMAGE_SCALE_SPRING_PROPS,\n          opacity: {\n            type: 'tween',\n            duration: 400\n          }\n        }\n      },\n      create: function create(_ref7) {\n        var root = _ref7.root,\n            props = _ref7.props;\n        root.ref.clip = root.appendChildView(root.createChildView(createClipView(_), {\n          id: props.id,\n          image: props.image,\n          crop: props.crop,\n          markup: props.markup,\n          resize: props.resize,\n          dirty: props.dirty,\n          background: props.background\n        }));\n      },\n      write: function write(_ref8) {\n        var root = _ref8.root,\n            props = _ref8.props,\n            shouldOptimize = _ref8.shouldOptimize;\n        var clip = root.ref.clip;\n        var image = props.image,\n            crop = props.crop,\n            markup = props.markup,\n            resize = props.resize,\n            dirty = props.dirty;\n        clip.crop = crop;\n        clip.markup = markup;\n        clip.resize = resize;\n        clip.dirty = dirty; // don't update clip layout\n\n        clip.opacity = shouldOptimize ? 0 : 1; // don't re-render if optimizing or hidden (width will be zero resulting in weird animations)\n\n        if (shouldOptimize || root.rect.element.hidden) return; // calculate scaled preview image size\n\n        var imageAspectRatio = image.height / image.width;\n        var aspectRatio = crop.aspectRatio || imageAspectRatio; // calculate container size\n\n        var containerWidth = root.rect.inner.width;\n        var containerHeight = root.rect.inner.height;\n        var fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        var minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n        var maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n        var panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n        var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n\n        if (panelAspectRatio && !allowMultiple) {\n          fixedPreviewHeight = containerWidth * panelAspectRatio;\n          aspectRatio = panelAspectRatio;\n        } // determine clip width and height\n\n\n        var clipHeight = fixedPreviewHeight !== null ? fixedPreviewHeight : Math.max(minPreviewHeight, Math.min(containerWidth * aspectRatio, maxPreviewHeight));\n        var clipWidth = clipHeight / aspectRatio;\n\n        if (clipWidth > containerWidth) {\n          clipWidth = containerWidth;\n          clipHeight = clipWidth * aspectRatio;\n        }\n\n        if (clipHeight > containerHeight) {\n          clipHeight = containerHeight;\n          clipWidth = containerHeight / aspectRatio;\n        }\n\n        clip.width = clipWidth;\n        clip.height = clipHeight;\n      }\n    });\n  };\n\n  var SVG_MASK = '<svg width=\"500\" height=\"200\" viewBox=\"0 0 500 200\" preserveAspectRatio=\"none\">\\n    <defs>\\n        <radialGradient id=\"gradient-__UID__\" cx=\".5\" cy=\"1.25\" r=\"1.15\">\\n            <stop offset=\\'50%\\' stop-color=\\'#000000\\'/>\\n            <stop offset=\\'56%\\' stop-color=\\'#0a0a0a\\'/>\\n            <stop offset=\\'63%\\' stop-color=\\'#262626\\'/>\\n            <stop offset=\\'69%\\' stop-color=\\'#4f4f4f\\'/>\\n            <stop offset=\\'75%\\' stop-color=\\'#808080\\'/>\\n            <stop offset=\\'81%\\' stop-color=\\'#b1b1b1\\'/>\\n            <stop offset=\\'88%\\' stop-color=\\'#dadada\\'/>\\n            <stop offset=\\'94%\\' stop-color=\\'#f6f6f6\\'/>\\n            <stop offset=\\'100%\\' stop-color=\\'#ffffff\\'/>\\n        </radialGradient>\\n        <mask id=\"mask-__UID__\">\\n            <rect x=\"0\" y=\"0\" width=\"500\" height=\"200\" fill=\"url(#gradient-__UID__)\"></rect>\\n        </mask>\\n    </defs>\\n    <rect x=\"0\" width=\"500\" height=\"200\" fill=\"currentColor\" mask=\"url(#mask-__UID__)\"></rect>\\n</svg>';\n  var SVGMaskUniqueId = 0;\n\n  var createImageOverlayView = function createImageOverlayView(fpAPI) {\n    return fpAPI.utils.createView({\n      name: 'image-preview-overlay',\n      tag: 'div',\n      ignoreRect: true,\n      create: function create(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n        var mask = SVG_MASK;\n\n        if (document.querySelector('base')) {\n          var url = new URL(window.location.href.replace(window.location.hash, '')).href;\n          mask = mask.replace(/url\\(\\#/g, 'url(' + url + '#');\n        }\n\n        SVGMaskUniqueId++;\n        root.element.classList.add('filepond--image-preview-overlay-'.concat(props.status));\n        root.element.innerHTML = mask.replace(/__UID__/g, SVGMaskUniqueId);\n      },\n      mixins: {\n        styles: ['opacity'],\n        animations: {\n          opacity: {\n            type: 'spring',\n            mass: 25\n          }\n        }\n      }\n    });\n  };\n  /**\n   * Bitmap Worker\n   */\n\n\n  var BitmapWorker = function BitmapWorker() {\n    self.onmessage = function (e) {\n      createImageBitmap(e.data.message.file).then(function (bitmap) {\n        self.postMessage({\n          id: e.data.id,\n          message: bitmap\n        }, [bitmap]);\n      });\n    };\n  };\n  /**\n   * ColorMatrix Worker\n   */\n\n\n  var ColorMatrixWorker = function ColorMatrixWorker() {\n    self.onmessage = function (e) {\n      var imageData = e.data.message.imageData;\n      var matrix = e.data.message.colorMatrix;\n      var data = imageData.data;\n      var l = data.length;\n      var m11 = matrix[0];\n      var m12 = matrix[1];\n      var m13 = matrix[2];\n      var m14 = matrix[3];\n      var m15 = matrix[4];\n      var m21 = matrix[5];\n      var m22 = matrix[6];\n      var m23 = matrix[7];\n      var m24 = matrix[8];\n      var m25 = matrix[9];\n      var m31 = matrix[10];\n      var m32 = matrix[11];\n      var m33 = matrix[12];\n      var m34 = matrix[13];\n      var m35 = matrix[14];\n      var m41 = matrix[15];\n      var m42 = matrix[16];\n      var m43 = matrix[17];\n      var m44 = matrix[18];\n      var m45 = matrix[19];\n      var index = 0,\n          r = 0.0,\n          g = 0.0,\n          b = 0.0,\n          a = 0.0;\n\n      for (; index < l; index += 4) {\n        r = data[index] / 255;\n        g = data[index + 1] / 255;\n        b = data[index + 2] / 255;\n        a = data[index + 3] / 255;\n        data[index] = Math.max(0, Math.min((r * m11 + g * m12 + b * m13 + a * m14 + m15) * 255, 255));\n        data[index + 1] = Math.max(0, Math.min((r * m21 + g * m22 + b * m23 + a * m24 + m25) * 255, 255));\n        data[index + 2] = Math.max(0, Math.min((r * m31 + g * m32 + b * m33 + a * m34 + m35) * 255, 255));\n        data[index + 3] = Math.max(0, Math.min((r * m41 + g * m42 + b * m43 + a * m44 + m45) * 255, 255));\n      }\n\n      self.postMessage({\n        id: e.data.id,\n        message: imageData\n      }, [imageData.data.buffer]);\n    };\n  };\n\n  var getImageSize = function getImageSize(url, cb) {\n    var image = new Image();\n\n    image.onload = function () {\n      var width = image.naturalWidth;\n      var height = image.naturalHeight;\n      image = null;\n      cb(width, height);\n    };\n\n    image.src = url;\n  };\n\n  var transforms = {\n    1: function _() {\n      return [1, 0, 0, 1, 0, 0];\n    },\n    2: function _(width) {\n      return [-1, 0, 0, 1, width, 0];\n    },\n    3: function _(width, height) {\n      return [-1, 0, 0, -1, width, height];\n    },\n    4: function _(width, height) {\n      return [1, 0, 0, -1, 0, height];\n    },\n    5: function _() {\n      return [0, 1, 1, 0, 0, 0];\n    },\n    6: function _(width, height) {\n      return [0, 1, -1, 0, height, 0];\n    },\n    7: function _(width, height) {\n      return [0, -1, -1, 0, height, width];\n    },\n    8: function _(width) {\n      return [0, -1, 1, 0, 0, width];\n    }\n  };\n\n  var fixImageOrientation = function fixImageOrientation(ctx, width, height, orientation) {\n    // no orientation supplied\n    if (orientation === -1) {\n      return;\n    }\n\n    ctx.transform.apply(ctx, transforms[orientation](width, height));\n  }; // draws the preview image to canvas\n\n\n  var createPreviewImage = function createPreviewImage(data, width, height, orientation) {\n    // can't draw on half pixels\n    width = Math.round(width);\n    height = Math.round(height); // draw image\n\n    var canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    var ctx = canvas.getContext('2d'); // if is rotated incorrectly swap width and height\n\n    if (orientation >= 5 && orientation <= 8) {\n      var _ref = [height, width];\n      width = _ref[0];\n      height = _ref[1];\n    } // correct image orientation\n\n\n    fixImageOrientation(ctx, width, height, orientation); // draw the image\n\n    ctx.drawImage(data, 0, 0, width, height);\n    return canvas;\n  };\n\n  var isBitmap = function isBitmap(file) {\n    return /^image/.test(file.type) && !/svg/.test(file.type);\n  };\n\n  var MAX_WIDTH = 10;\n  var MAX_HEIGHT = 10;\n\n  var calculateAverageColor = function calculateAverageColor(image) {\n    var scalar = Math.min(MAX_WIDTH / image.width, MAX_HEIGHT / image.height);\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n    var width = canvas.width = Math.ceil(image.width * scalar);\n    var height = canvas.height = Math.ceil(image.height * scalar);\n    ctx.drawImage(image, 0, 0, width, height);\n    var data = null;\n\n    try {\n      data = ctx.getImageData(0, 0, width, height).data;\n    } catch (e) {\n      return null;\n    }\n\n    var l = data.length;\n    var r = 0;\n    var g = 0;\n    var b = 0;\n    var i = 0;\n\n    for (; i < l; i += 4) {\n      r += data[i] * data[i];\n      g += data[i + 1] * data[i + 1];\n      b += data[i + 2] * data[i + 2];\n    }\n\n    r = averageColor(r, l);\n    g = averageColor(g, l);\n    b = averageColor(b, l);\n    return {\n      r: r,\n      g: g,\n      b: b\n    };\n  };\n\n  var averageColor = function averageColor(c, l) {\n    return Math.floor(Math.sqrt(c / (l / 4)));\n  };\n\n  var cloneCanvas = function cloneCanvas(origin, target) {\n    target = target || document.createElement('canvas');\n    target.width = origin.width;\n    target.height = origin.height;\n    var ctx = target.getContext('2d');\n    ctx.drawImage(origin, 0, 0);\n    return target;\n  };\n\n  var cloneImageData = function cloneImageData(imageData) {\n    var id;\n\n    try {\n      id = new ImageData(imageData.width, imageData.height);\n    } catch (e) {\n      var canvas = document.createElement('canvas');\n      var ctx = canvas.getContext('2d');\n      id = ctx.createImageData(imageData.width, imageData.height);\n    }\n\n    id.data.set(new Uint8ClampedArray(imageData.data));\n    return id;\n  };\n\n  var loadImage = function loadImage(url) {\n    return new Promise(function (resolve, reject) {\n      var img = new Image();\n      img.crossOrigin = 'Anonymous';\n\n      img.onload = function () {\n        resolve(img);\n      };\n\n      img.onerror = function (e) {\n        reject(e);\n      };\n\n      img.src = url;\n    });\n  };\n\n  var createImageWrapperView = function createImageWrapperView(_) {\n    // create overlay view\n    var OverlayView = createImageOverlayView(_);\n    var ImageView = createImageView(_);\n    var createWorker = _.utils.createWorker;\n\n    var applyFilter = function applyFilter(root, filter, target) {\n      return new Promise(function (resolve) {\n        // will store image data for future filter updates\n        if (!root.ref.imageData) {\n          root.ref.imageData = target.getContext('2d').getImageData(0, 0, target.width, target.height);\n        } // get image data reference\n\n\n        var imageData = cloneImageData(root.ref.imageData);\n\n        if (!filter || filter.length !== 20) {\n          target.getContext('2d').putImageData(imageData, 0, 0);\n          return resolve();\n        }\n\n        var worker = createWorker(ColorMatrixWorker);\n        worker.post({\n          imageData: imageData,\n          colorMatrix: filter\n        }, function (response) {\n          // apply filtered colors\n          target.getContext('2d').putImageData(response, 0, 0); // stop worker\n\n          worker.terminate(); // done!\n\n          resolve();\n        }, [imageData.data.buffer]);\n      });\n    };\n\n    var removeImageView = function removeImageView(root, imageView) {\n      root.removeChildView(imageView);\n      imageView.image.width = 1;\n      imageView.image.height = 1;\n\n      imageView._destroy();\n    }; // remove an image\n\n\n    var shiftImage = function shiftImage(_ref) {\n      var root = _ref.root;\n      var imageView = root.ref.images.shift();\n      imageView.opacity = 0;\n      imageView.translateY = -15;\n      root.ref.imageViewBin.push(imageView);\n      return imageView;\n    }; // add new image\n\n\n    var pushImage = function pushImage(_ref2) {\n      var root = _ref2.root,\n          props = _ref2.props,\n          image = _ref2.image;\n      var id = props.id;\n      var item = root.query('GET_ITEM', {\n        id: id\n      });\n      if (!item) return;\n      var crop = item.getMetadata('crop') || {\n        center: {\n          x: 0.5,\n          y: 0.5\n        },\n        flip: {\n          horizontal: false,\n          vertical: false\n        },\n        zoom: 1,\n        rotation: 0,\n        aspectRatio: null\n      };\n      var background = root.query('GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR');\n      var markup;\n      var resize;\n      var dirty = false;\n\n      if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n        markup = item.getMetadata('markup') || [];\n        resize = item.getMetadata('resize');\n        dirty = true;\n      } // append image presenter\n\n\n      var imageView = root.appendChildView(root.createChildView(ImageView, {\n        id: id,\n        image: image,\n        crop: crop,\n        resize: resize,\n        markup: markup,\n        dirty: dirty,\n        background: background,\n        opacity: 0,\n        scaleX: 1.15,\n        scaleY: 1.15,\n        translateY: 15\n      }), root.childViews.length);\n      root.ref.images.push(imageView); // reveal the preview image\n\n      imageView.opacity = 1;\n      imageView.scaleX = 1;\n      imageView.scaleY = 1;\n      imageView.translateY = 0; // the preview is now ready to be drawn\n\n      setTimeout(function () {\n        root.dispatch('DID_IMAGE_PREVIEW_SHOW', {\n          id: id\n        });\n      }, 250);\n    };\n\n    var updateImage = function updateImage(_ref3) {\n      var root = _ref3.root,\n          props = _ref3.props;\n      var item = root.query('GET_ITEM', {\n        id: props.id\n      });\n      if (!item) return;\n      var imageView = root.ref.images[root.ref.images.length - 1];\n      imageView.crop = item.getMetadata('crop');\n      imageView.background = root.query('GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR');\n\n      if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n        imageView.dirty = true;\n        imageView.resize = item.getMetadata('resize');\n        imageView.markup = item.getMetadata('markup');\n      }\n    }; // replace image preview\n\n\n    var didUpdateItemMetadata = function didUpdateItemMetadata(_ref4) {\n      var root = _ref4.root,\n          props = _ref4.props,\n          action = _ref4.action; // only filter and crop trigger redraw\n\n      if (!/crop|filter|markup|resize/.test(action.change.key)) return; // no images to update, exit\n\n      if (!root.ref.images.length) return; // no item found, exit\n\n      var item = root.query('GET_ITEM', {\n        id: props.id\n      });\n      if (!item) return; // for now, update existing image when filtering\n\n      if (/filter/.test(action.change.key)) {\n        var imageView = root.ref.images[root.ref.images.length - 1];\n        applyFilter(root, action.change.value, imageView.image);\n        return;\n      }\n\n      if (/crop|markup|resize/.test(action.change.key)) {\n        var crop = item.getMetadata('crop');\n        var image = root.ref.images[root.ref.images.length - 1]; // if aspect ratio has changed, we need to create a new image\n\n        if (crop && crop.aspectRatio && image.crop && image.crop.aspectRatio && Math.abs(crop.aspectRatio - image.crop.aspectRatio) > 0.00001) {\n          var _imageView = shiftImage({\n            root: root\n          });\n\n          pushImage({\n            root: root,\n            props: props,\n            image: cloneCanvas(_imageView.image)\n          });\n        } // if not, we can update the current image\n        else {\n          updateImage({\n            root: root,\n            props: props\n          });\n        }\n      }\n    };\n\n    var canCreateImageBitmap = function canCreateImageBitmap(file) {\n      // Firefox versions before 58 will freeze when running createImageBitmap\n      // in a Web Worker so we detect those versions and return false for support\n      var userAgent = window.navigator.userAgent;\n      var isFirefox = userAgent.match(/Firefox\\/([0-9]+)\\./);\n      var firefoxVersion = isFirefox ? parseInt(isFirefox[1]) : null;\n      if (firefoxVersion <= 58) return false;\n      return 'createImageBitmap' in window && isBitmap(file);\n    };\n    /**\n     * Write handler for when preview container has been created\n     */\n\n\n    var didCreatePreviewContainer = function didCreatePreviewContainer(_ref5) {\n      var root = _ref5.root,\n          props = _ref5.props;\n      var id = props.id; // we need to get the file data to determine the eventual image size\n\n      var item = root.query('GET_ITEM', id);\n      if (!item) return; // get url to file (we'll revoke it later on when done)\n\n      var fileURL = URL.createObjectURL(item.file); // determine image size of this item\n\n      getImageSize(fileURL, function (width, height) {\n        // we can now scale the panel to the final size\n        root.dispatch('DID_IMAGE_PREVIEW_CALCULATE_SIZE', {\n          id: id,\n          width: width,\n          height: height\n        });\n      });\n    };\n\n    var drawPreview = function drawPreview(_ref6) {\n      var root = _ref6.root,\n          props = _ref6.props;\n      var id = props.id; // we need to get the file data to determine the eventual image size\n\n      var item = root.query('GET_ITEM', id);\n      if (!item) return; // get url to file (we'll revoke it later on when done)\n\n      var fileURL = URL.createObjectURL(item.file); // fallback\n\n      var loadPreviewFallback = function loadPreviewFallback() {\n        // let's scale the image in the main thread :(\n        loadImage(fileURL).then(previewImageLoaded);\n      }; // image is now ready\n\n\n      var previewImageLoaded = function previewImageLoaded(imageData) {\n        // the file url is no longer needed\n        URL.revokeObjectURL(fileURL); // draw the scaled down version here and use that as source so bitmapdata can be closed\n        // orientation info\n\n        var exif = item.getMetadata('exif') || {};\n        var orientation = exif.orientation || -1; // get width and height from action, and swap if orientation is incorrect\n\n        var width = imageData.width,\n            height = imageData.height; // if no width or height, just return early.\n\n        if (!width || !height) return;\n\n        if (orientation >= 5 && orientation <= 8) {\n          var _ref7 = [height, width];\n          width = _ref7[0];\n          height = _ref7[1];\n        } // scale canvas based on pixel density\n        // we multiply by .75 as that creates smaller but still clear images on screens with high res displays\n\n\n        var pixelDensityFactor = Math.max(1, window.devicePixelRatio * 0.75); // we want as much pixels to work with as possible,\n        // this multiplies the minimum image resolution,\n        // so when zooming in it doesn't get too blurry\n\n        var zoomFactor = root.query('GET_IMAGE_PREVIEW_ZOOM_FACTOR'); // imaeg scale factor\n\n        var scaleFactor = zoomFactor * pixelDensityFactor; // calculate scaled preview image size\n\n        var previewImageRatio = height / width; // calculate image preview height and width\n\n        var previewContainerWidth = root.rect.element.width;\n        var previewContainerHeight = root.rect.element.height;\n        var imageWidth = previewContainerWidth;\n        var imageHeight = imageWidth * previewImageRatio;\n\n        if (previewImageRatio > 1) {\n          imageWidth = Math.min(width, previewContainerWidth * scaleFactor);\n          imageHeight = imageWidth * previewImageRatio;\n        } else {\n          imageHeight = Math.min(height, previewContainerHeight * scaleFactor);\n          imageWidth = imageHeight / previewImageRatio;\n        } // transfer to image tag so no canvas memory wasted on iOS\n\n\n        var previewImage = createPreviewImage(imageData, imageWidth, imageHeight, orientation); // done\n\n        var done = function done() {\n          // calculate average image color, disabled for now\n          var averageColor = root.query('GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR') ? calculateAverageColor(data) : null;\n          item.setMetadata('color', averageColor, true); // data has been transferred to canvas ( if was ImageBitmap )\n\n          if ('close' in imageData) {\n            imageData.close();\n          } // show the overlay\n\n\n          root.ref.overlayShadow.opacity = 1; // create the first image\n\n          pushImage({\n            root: root,\n            props: props,\n            image: previewImage\n          });\n        }; // apply filter\n\n\n        var filter = item.getMetadata('filter');\n\n        if (filter) {\n          applyFilter(root, filter, previewImage).then(done);\n        } else {\n          done();\n        }\n      }; // if we support scaling using createImageBitmap we use a worker\n\n\n      if (canCreateImageBitmap(item.file)) {\n        // let's scale the image in a worker\n        var worker = createWorker(BitmapWorker);\n        worker.post({\n          file: item.file\n        }, function (imageBitmap) {\n          // destroy worker\n          worker.terminate(); // no bitmap returned, must be something wrong,\n          // try the oldschool way\n\n          if (!imageBitmap) {\n            loadPreviewFallback();\n            return;\n          } // yay we got our bitmap, let's continue showing the preview\n\n\n          previewImageLoaded(imageBitmap);\n        });\n      } else {\n        // create fallback preview\n        loadPreviewFallback();\n      }\n    };\n    /**\n     * Write handler for when the preview image is ready to be animated\n     */\n\n\n    var didDrawPreview = function didDrawPreview(_ref8) {\n      var root = _ref8.root; // get last added image\n\n      var image = root.ref.images[root.ref.images.length - 1];\n      image.translateY = 0;\n      image.scaleX = 1.0;\n      image.scaleY = 1.0;\n      image.opacity = 1;\n    };\n    /**\n     * Write handler for when the preview has been loaded\n     */\n\n\n    var restoreOverlay = function restoreOverlay(_ref9) {\n      var root = _ref9.root;\n      root.ref.overlayShadow.opacity = 1;\n      root.ref.overlayError.opacity = 0;\n      root.ref.overlaySuccess.opacity = 0;\n    };\n\n    var didThrowError = function didThrowError(_ref10) {\n      var root = _ref10.root;\n      root.ref.overlayShadow.opacity = 0.25;\n      root.ref.overlayError.opacity = 1;\n    };\n\n    var didCompleteProcessing = function didCompleteProcessing(_ref11) {\n      var root = _ref11.root;\n      root.ref.overlayShadow.opacity = 0.25;\n      root.ref.overlaySuccess.opacity = 1;\n    };\n    /**\n     * Constructor\n     */\n\n\n    var create = function create(_ref12) {\n      var root = _ref12.root; // image view\n\n      root.ref.images = []; // the preview image data (we need this to filter the image)\n\n      root.ref.imageData = null; // image bin\n\n      root.ref.imageViewBin = []; // image overlays\n\n      root.ref.overlayShadow = root.appendChildView(root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'idle'\n      }));\n      root.ref.overlaySuccess = root.appendChildView(root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'success'\n      }));\n      root.ref.overlayError = root.appendChildView(root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'failure'\n      }));\n    };\n\n    return _.utils.createView({\n      name: 'image-preview-wrapper',\n      create: create,\n      styles: ['height'],\n      apis: ['height'],\n      destroy: function destroy(_ref13) {\n        var root = _ref13.root; // we resize the image so memory on iOS 12 is released more quickly (it seems)\n\n        root.ref.images.forEach(function (imageView) {\n          imageView.image.width = 1;\n          imageView.image.height = 1;\n        });\n      },\n      didWriteView: function didWriteView(_ref14) {\n        var root = _ref14.root;\n        root.ref.images.forEach(function (imageView) {\n          imageView.dirty = false;\n        });\n      },\n      write: _.utils.createRoute({\n        // image preview stated\n        DID_IMAGE_PREVIEW_DRAW: didDrawPreview,\n        DID_IMAGE_PREVIEW_CONTAINER_CREATE: didCreatePreviewContainer,\n        DID_FINISH_CALCULATE_PREVIEWSIZE: drawPreview,\n        DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata,\n        // file states\n        DID_THROW_ITEM_LOAD_ERROR: didThrowError,\n        DID_THROW_ITEM_PROCESSING_ERROR: didThrowError,\n        DID_THROW_ITEM_INVALID: didThrowError,\n        DID_COMPLETE_ITEM_PROCESSING: didCompleteProcessing,\n        DID_START_ITEM_PROCESSING: restoreOverlay,\n        DID_REVERT_ITEM_PROCESSING: restoreOverlay\n      }, function (_ref15) {\n        var root = _ref15.root; // views on death row\n\n        var viewsToRemove = root.ref.imageViewBin.filter(function (imageView) {\n          return imageView.opacity === 0;\n        }); // views to retain\n\n        root.ref.imageViewBin = root.ref.imageViewBin.filter(function (imageView) {\n          return imageView.opacity > 0;\n        }); // remove these views\n\n        viewsToRemove.forEach(function (imageView) {\n          return removeImageView(root, imageView);\n        });\n        viewsToRemove.length = 0;\n      })\n    });\n  };\n  /**\n   * Image Preview Plugin\n   */\n\n\n  var plugin = function plugin(fpAPI) {\n    var addFilter = fpAPI.addFilter,\n        utils = fpAPI.utils;\n    var Type = utils.Type,\n        createRoute = utils.createRoute,\n        isFile = utils.isFile; // imagePreviewView\n\n    var imagePreviewView = createImageWrapperView(fpAPI); // called for each view that is created right after the 'create' method\n\n    addFilter('CREATE_VIEW', function (viewAPI) {\n      // get reference to created view\n      var is = viewAPI.is,\n          view = viewAPI.view,\n          query = viewAPI.query; // only hook up to item view and only if is enabled for this cropper\n\n      if (!is('file') || !query('GET_ALLOW_IMAGE_PREVIEW')) return; // create the image preview plugin, but only do so if the item is an image\n\n      var didLoadItem = function didLoadItem(_ref) {\n        var root = _ref.root,\n            props = _ref.props;\n        var id = props.id;\n        var item = query('GET_ITEM', id); // item could theoretically have been removed in the mean time\n\n        if (!item || !isFile(item.file) || item.archived) return; // get the file object\n\n        var file = item.file; // exit if this is not an image\n\n        if (!isPreviewableImage(file)) return; // test if is filtered\n\n        if (!query('GET_IMAGE_PREVIEW_FILTER_ITEM')(item)) return; // exit if image size is too high and no createImageBitmap support\n        // this would simply bring the browser to its knees and that is not what we want\n\n        var supportsCreateImageBitmap = ('createImageBitmap' in (window || {}));\n        var maxPreviewFileSize = query('GET_IMAGE_PREVIEW_MAX_FILE_SIZE');\n        if (!supportsCreateImageBitmap && maxPreviewFileSize && file.size > maxPreviewFileSize) return; // set preview view\n\n        root.ref.imagePreview = view.appendChildView(view.createChildView(imagePreviewView, {\n          id: id\n        })); // update height if is fixed\n\n        var fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n\n        if (fixedPreviewHeight) {\n          root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n            id: item.id,\n            height: fixedPreviewHeight\n          });\n        } // now ready\n\n\n        var queue = !supportsCreateImageBitmap && file.size > query('GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE');\n        root.dispatch('DID_IMAGE_PREVIEW_CONTAINER_CREATE', {\n          id: id\n        }, queue);\n      };\n\n      var rescaleItem = function rescaleItem(root, props) {\n        if (!root.ref.imagePreview) return;\n        var id = props.id; // get item\n\n        var item = root.query('GET_ITEM', {\n          id: id\n        });\n        if (!item) return; // if is fixed height or panel has aspect ratio, exit here, height has already been defined\n\n        var panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n        var itemPanelAspectRatio = root.query('GET_ITEM_PANEL_ASPECT_RATIO');\n        var fixedHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        if (panelAspectRatio || itemPanelAspectRatio || fixedHeight) return; // no data!\n\n        var _root$ref = root.ref,\n            imageWidth = _root$ref.imageWidth,\n            imageHeight = _root$ref.imageHeight;\n        if (!imageWidth || !imageHeight) return; // get height min and max\n\n        var minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n        var maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT'); // orientation info\n\n        var exif = item.getMetadata('exif') || {};\n        var orientation = exif.orientation || -1; // get width and height from action, and swap of orientation is incorrect\n\n        if (orientation >= 5 && orientation <= 8) {\n          var _ref2 = [imageHeight, imageWidth];\n          imageWidth = _ref2[0];\n          imageHeight = _ref2[1];\n        } // scale up width and height when we're dealing with an SVG\n\n\n        if (!isBitmap(item.file) || root.query('GET_IMAGE_PREVIEW_UPSCALE')) {\n          var scalar = 2048 / imageWidth;\n          imageWidth *= scalar;\n          imageHeight *= scalar;\n        } // image aspect ratio\n\n\n        var imageAspectRatio = imageHeight / imageWidth; // we need the item to get to the crop size\n\n        var previewAspectRatio = (item.getMetadata('crop') || {}).aspectRatio || imageAspectRatio; // preview height range\n\n        var previewHeightMax = Math.max(minPreviewHeight, Math.min(imageHeight, maxPreviewHeight));\n        var itemWidth = root.rect.element.width;\n        var previewHeight = Math.min(itemWidth * previewAspectRatio, previewHeightMax); // request update to panel height\n\n        root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n          id: item.id,\n          height: previewHeight\n        });\n      };\n\n      var didResizeView = function didResizeView(_ref3) {\n        var root = _ref3.root; // actions in next write operation\n\n        root.ref.shouldRescale = true;\n      };\n\n      var didUpdateItemMetadata = function didUpdateItemMetadata(_ref4) {\n        var root = _ref4.root,\n            action = _ref4.action;\n        if (action.change.key !== 'crop') return; // actions in next write operation\n\n        root.ref.shouldRescale = true;\n      };\n\n      var didCalculatePreviewSize = function didCalculatePreviewSize(_ref5) {\n        var root = _ref5.root,\n            action = _ref5.action; // remember dimensions\n\n        root.ref.imageWidth = action.width;\n        root.ref.imageHeight = action.height; // actions in next write operation\n\n        root.ref.shouldRescale = true;\n        root.ref.shouldDrawPreview = true; // as image load could take a while and fire when draw loop is resting we need to give it a kick\n\n        root.dispatch('KICK');\n      }; // start writing\n\n\n      view.registerWriter(createRoute({\n        DID_RESIZE_ROOT: didResizeView,\n        DID_STOP_RESIZE: didResizeView,\n        DID_LOAD_ITEM: didLoadItem,\n        DID_IMAGE_PREVIEW_CALCULATE_SIZE: didCalculatePreviewSize,\n        DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata\n      }, function (_ref6) {\n        var root = _ref6.root,\n            props = _ref6.props; // no preview view attached\n\n        if (!root.ref.imagePreview) return; // don't do anything while hidden\n\n        if (root.rect.element.hidden) return; // resize the item panel\n\n        if (root.ref.shouldRescale) {\n          rescaleItem(root, props);\n          root.ref.shouldRescale = false;\n        }\n\n        if (root.ref.shouldDrawPreview) {\n          // queue till next frame so we're sure the height has been applied this forces the draw image call inside the wrapper view to use the correct height\n          requestAnimationFrame(function () {\n            // this requestAnimationFrame nesting is horrible but it fixes an issue with 100hz displays on Chrome\n            // https://github.com/pqina/filepond-plugin-image-preview/issues/57\n            requestAnimationFrame(function () {\n              root.dispatch('DID_FINISH_CALCULATE_PREVIEWSIZE', {\n                id: props.id\n              });\n            });\n          });\n          root.ref.shouldDrawPreview = false;\n        }\n      }));\n    }); // expose plugin\n\n    return {\n      options: {\n        // Enable or disable image preview\n        allowImagePreview: [true, Type.BOOLEAN],\n        // filters file items to determine which are shown as preview\n        imagePreviewFilterItem: [function () {\n          return true;\n        }, Type.FUNCTION],\n        // Fixed preview height\n        imagePreviewHeight: [null, Type.INT],\n        // Min image height\n        imagePreviewMinHeight: [44, Type.INT],\n        // Max image height\n        imagePreviewMaxHeight: [256, Type.INT],\n        // Max size of preview file for when createImageBitmap is not supported\n        imagePreviewMaxFileSize: [null, Type.INT],\n        // The amount of extra pixels added to the image preview to allow comfortable zooming\n        imagePreviewZoomFactor: [2, Type.INT],\n        // Should we upscale small images to fit the max bounding box of the preview area\n        imagePreviewUpscale: [false, Type.BOOLEAN],\n        // Max size of preview file that we allow to try to instant preview if createImageBitmap is not supported, else image is queued for loading\n        imagePreviewMaxInstantPreviewFileSize: [1000000, Type.INT],\n        // Style of the transparancy indicator used behind images\n        imagePreviewTransparencyIndicator: [null, Type.STRING],\n        // Enables or disables reading average image color\n        imagePreviewCalculateAverageImageColor: [false, Type.BOOLEAN],\n        // Enables or disables the previewing of markup\n        imagePreviewMarkupShow: [true, Type.BOOLEAN],\n        // Allows filtering of markup to only show certain shapes\n        imagePreviewMarkupFilter: [function () {\n          return true;\n        }, Type.FUNCTION]\n      }\n    };\n  }; // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n\n\n  var isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n\n  if (isBrowser) {\n    document.dispatchEvent(new CustomEvent('FilePond:pluginloaded', {\n      detail: plugin\n    }));\n  }\n\n  return plugin;\n});","map":{"version":3,"names":["global","factory","exports","module","define","amd","self","FilePondPluginImagePreview","isPreviewableImage","file","test","type","_typeof","obj","Symbol","iterator","constructor","prototype","REACT_ELEMENT_TYPE","_jsx","props","key","children","for","defaultProps","childrenLength","arguments","length","propName","childArray","Array","i","$$typeof","undefined","ref","_owner","_asyncIterator","iterable","method","asyncIterator","call","TypeError","_AwaitValue","value","wrapped","_AsyncGenerator","gen","front","back","send","arg","Promise","resolve","reject","request","next","resume","result","wrappedAwait","then","settle","done","err","_invoke","return","throw","_wrapAsyncGenerator","fn","apply","_awaitAsyncGenerator","_asyncGeneratorDelegate","inner","awaitWrap","iter","waiting","pump","asyncGeneratorStep","_next","_throw","info","error","_asyncToGenerator","args","_classCallCheck","instance","Constructor","_defineProperties","target","descriptor","enumerable","configurable","writable","Object","defineProperty","_createClass","protoProps","staticProps","_defineEnumerableProperties","descs","desc","getOwnPropertySymbols","objectSymbols","sym","_defaults","defaults","keys","getOwnPropertyNames","getOwnPropertyDescriptor","_defineProperty","_extends","assign","source","hasOwnProperty","_objectSpread","ownKeys","concat","filter","forEach","_inherits","subClass","superClass","create","_setPrototypeOf","_inheritsLoose","__proto__","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","p","isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","toString","e","_construct","Parent","Class","a","push","Function","bind","_isNativeFunction","indexOf","_wrapNativeSuper","_cache","Map","has","get","set","Wrapper","_instanceof","left","right","hasInstance","_interopRequireDefault","__esModule","default","_interopRequireWildcard","newObj","_newArrowCheck","innerThis","boundThis","_objectDestructuringEmpty","_objectWithoutPropertiesLoose","excluded","sourceKeys","_objectWithoutProperties","sourceSymbolKeys","propertyIsEnumerable","_assertThisInitialized","ReferenceError","_possibleConstructorReturn","_superPropBase","object","property","_get","receiver","base","_set","isStrict","s","Error","_taggedTemplateLiteral","strings","raw","slice","freeze","defineProperties","_taggedTemplateLiteralLoose","_temporalRef","val","name","_temporalUndefined","_readOnlyError","_classNameTDZError","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_slicedToArrayLoose","_iterableToArrayLimitLoose","_toArray","_iterableToArray","_toConsumableArray","_arrayWithoutHoles","_nonIterableSpread","isArray","arr2","from","_arr","_n","_d","_e","_i","_s","_iterator","_step","_skipFirstGeneratorNext","it","_toPrimitive","input","hint","prim","toPrimitive","res","String","Number","_toPropertyKey","_initializerWarningHelper","context","_initializerDefineProperty","initializer","_applyDecoratedDescriptor","decorators","reverse","reduce","decorator","id","_classPrivateFieldLooseKey","_classPrivateFieldLooseBase","privateKey","_classPrivateFieldGet","privateMap","_classPrivateFieldSet","_classStaticPrivateFieldSpecGet","classConstructor","_classStaticPrivateFieldSpecSet","_classStaticPrivateMethodGet","_classStaticPrivateMethodSet","_decorate","mixins","api","_getDecoratorsApi","r","initialize","O","initializeInstanceElements","decorated","elements","decorateClass","_coalesceClassElements","d","map","_createElementDescriptor","initializeClassElements","F","runClassFinishers","finishers","elementsDefinitionOrder","kind","element","placement","defineClassElement","proto","newElements","placements","static","own","addElementPlacement","_hasDecorators","elementFinishersExtras","decorateElement","extras","decorateConstructor","silent","splice","elementObject","fromElementDescriptor","elementFinisherExtras","toElementFinisherExtras","finisher","newExtras","j","fromClassDescriptor","elementsAndFinisher","toClassDescriptor","k","toStringTag","toElementDescriptors","elementObjects","toElementDescriptor","disallowProperty","_optionalCallableProperty","newConstructor","objectType","def","_coalesceGetterSetter","other","isSameElement","find","_isDataDescriptor","_classPrivateMethodGet","privateSet","_classPrivateMethodSet","_wrapRegExp","re","groups","BabelRegExp","_RegExp","RegExp","_super","_groups","WeakMap","_this","exec","str","buildGroups","replace","substitution","_","g","vectorMultiply","v","amount","createVector","x","y","vectorAdd","b","vectorNormalize","l","Math","sqrt","vectorRotate","radians","origin","cos","sin","t","getMarkupValue","size","scalar","axis","parseFloat","min","width","height","getMarkupStyles","markup","scale","lineStyle","borderStyle","fill","backgroundColor","fontColor","stroke","borderColor","lineColor","strokeWidth","borderWidth","lineWidth","lineCap","lineJoin","dashes","join","opacity","isDefined","getMarkupRect","rect","top","bottom","pointsToPathShape","points","point","index","setAttributes","attr","setAttribute","ns","svg","tag","document","createElementNS","updateRect","styles","updateEllipse","cx","cy","rx","ry","IMAGE_FIT_STYLE","contain","cover","updateImage","preserveAspectRatio","fit","TEXT_ANCHOR","center","updateText","fontSize","fontFamily","fontWeight","textAlign","text","textContent","updateLine","line","childNodes","begin","end","x1","y1","x2","y2","lineDecoration","style","display","arrowBeginRotationPoint","arrowBeginCenter","arrowBeginA","arrowBeginB","arrowEndRotationPoint","arrowEndCenter","arrowEndA","arrowEndB","updatePath","createShape","node","createImage","shape","onload","setAttributeNS","src","createLine","appendChild","CREATE_TYPE_ROUTES","image","ellipse","path","UPDATE_TYPE_ROUTES","createMarkupByType","updateMarkupByType","MARKUP_RECT","toOptionalFraction","prepareMarkup","_markup","prev","curr","zIndex","sortMarkupByZIndex","createMarkupView","utils","createView","ignoreRect","apis","write","_ref","root","dirty","crop","resize","viewWidth","viewHeight","cropWidth","cropHeight","_size","outputWidth","outputHeight","outputFit","mode","outputUpscale","upscale","shouldUpscale","scalarWidth","scalarHeight","max","innerHTML","markupFilter","query","sort","settings","createVector$1","vectorDot","vectorSubtract","vectorDistanceSquared","vectorDistance","getOffsetPointOnEdge","rotation","A","B","C","sinA","sinB","sinC","cosC","ratio","c","getRotatedRectSize","w","h","hor","ver","tl","abs","tr","bl","calculateCanvasSize","canvasAspectRatio","zoom","imageAspectRatio","canvasWidth","canvasHeight","imgWidth","imgHeight","getImageRectZoomFactor","imageRect","cropRect","imageWidth","imageHeight","rotatedCropSize","getCenteredCropRect","container","aspectRatio","getCurrentCropSize","imageSize","canvasSize","canvasCenter","stage","shouldLimit","scaleToFit","stageZoomFactor","widthFloat","heightFloat","round","IMAGE_SCALE_SPRING_PROPS","stiffness","damping","mass","createBitmapView","createImageCanvasWrapper","animations","originX","originY","scaleX","scaleY","translateX","translateY","rotateZ","_ref2","bitmap","appendChildView","createChildView","_ref3","flip","horizontal","vertical","createClipView","duration","didWriteView","_ref4","background","_ref5","createMarkup","destroyMarkup","removeChildView","transparencyIndicator","dataset","_ref6","shouldOptimize","translation","PI","cropAspectRatio","imageView","createImageView","_ref7","clip","_ref8","hidden","containerWidth","containerHeight","fixedPreviewHeight","minPreviewHeight","maxPreviewHeight","panelAspectRatio","allowMultiple","clipHeight","clipWidth","SVG_MASK","SVGMaskUniqueId","createImageOverlayView","fpAPI","mask","querySelector","url","URL","window","location","href","hash","classList","add","status","BitmapWorker","onmessage","createImageBitmap","data","message","postMessage","ColorMatrixWorker","imageData","matrix","colorMatrix","m11","m12","m13","m14","m15","m21","m22","m23","m24","m25","m31","m32","m33","m34","m35","m41","m42","m43","m44","m45","buffer","getImageSize","cb","Image","naturalWidth","naturalHeight","transforms","fixImageOrientation","ctx","orientation","transform","createPreviewImage","canvas","createElement","getContext","drawImage","isBitmap","MAX_WIDTH","MAX_HEIGHT","calculateAverageColor","ceil","getImageData","averageColor","floor","cloneCanvas","cloneImageData","ImageData","createImageData","Uint8ClampedArray","loadImage","img","crossOrigin","onerror","createImageWrapperView","OverlayView","ImageView","createWorker","applyFilter","putImageData","worker","post","response","terminate","removeImageView","_destroy","shiftImage","images","shift","imageViewBin","pushImage","item","getMetadata","childViews","setTimeout","dispatch","didUpdateItemMetadata","action","change","_imageView","canCreateImageBitmap","userAgent","navigator","isFirefox","match","firefoxVersion","parseInt","didCreatePreviewContainer","fileURL","createObjectURL","drawPreview","loadPreviewFallback","previewImageLoaded","revokeObjectURL","exif","pixelDensityFactor","devicePixelRatio","zoomFactor","scaleFactor","previewImageRatio","previewContainerWidth","previewContainerHeight","previewImage","setMetadata","close","overlayShadow","imageBitmap","didDrawPreview","restoreOverlay","_ref9","overlayError","overlaySuccess","didThrowError","_ref10","didCompleteProcessing","_ref11","_ref12","destroy","_ref13","_ref14","createRoute","DID_IMAGE_PREVIEW_DRAW","DID_IMAGE_PREVIEW_CONTAINER_CREATE","DID_FINISH_CALCULATE_PREVIEWSIZE","DID_UPDATE_ITEM_METADATA","DID_THROW_ITEM_LOAD_ERROR","DID_THROW_ITEM_PROCESSING_ERROR","DID_THROW_ITEM_INVALID","DID_COMPLETE_ITEM_PROCESSING","DID_START_ITEM_PROCESSING","DID_REVERT_ITEM_PROCESSING","_ref15","viewsToRemove","plugin","addFilter","Type","isFile","imagePreviewView","viewAPI","is","view","didLoadItem","archived","supportsCreateImageBitmap","maxPreviewFileSize","imagePreview","queue","rescaleItem","itemPanelAspectRatio","fixedHeight","_root$ref","previewAspectRatio","previewHeightMax","itemWidth","previewHeight","didResizeView","shouldRescale","didCalculatePreviewSize","shouldDrawPreview","registerWriter","DID_RESIZE_ROOT","DID_STOP_RESIZE","DID_LOAD_ITEM","DID_IMAGE_PREVIEW_CALCULATE_SIZE","requestAnimationFrame","options","allowImagePreview","BOOLEAN","imagePreviewFilterItem","FUNCTION","imagePreviewHeight","INT","imagePreviewMinHeight","imagePreviewMaxHeight","imagePreviewMaxFileSize","imagePreviewZoomFactor","imagePreviewUpscale","imagePreviewMaxInstantPreviewFileSize","imagePreviewTransparencyIndicator","STRING","imagePreviewCalculateAverageImageColor","imagePreviewMarkupShow","imagePreviewMarkupFilter","isBrowser","dispatchEvent","CustomEvent","detail"],"sources":["C:/Users/kirk6/Desktop/GTBootcamp/p3p/portfolio-app/node_modules/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"],"sourcesContent":["/*!\n * FilePondPluginImagePreview 4.6.11\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined'\n    ? (module.exports = factory())\n    : typeof define === 'function' && define.amd\n    ? define(factory)\n    : ((global = global || self),\n      (global.FilePondPluginImagePreview = factory()));\n})(this, function() {\n  'use strict';\n\n  // test if file is of type image and can be viewed in canvas\n  var isPreviewableImage = function isPreviewableImage(file) {\n    return /^image/.test(file.type);\n  };\n\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function(obj) {\n        return obj &&\n          typeof Symbol === 'function' &&\n          obj.constructor === Symbol &&\n          obj !== Symbol.prototype\n          ? 'symbol'\n          : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var REACT_ELEMENT_TYPE;\n\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE =\n        (typeof Symbol === 'function' &&\n          Symbol.for &&\n          Symbol.for('react.element')) ||\n        0xeac7;\n    }\n\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n\n  function _asyncIterator(iterable) {\n    var method;\n\n    if (typeof Symbol === 'function') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n\n    throw new TypeError('Object is not async iterable');\n  }\n\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n\n  function _AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function(resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(\n          function(arg) {\n            if (wrappedAwait) {\n              resume('next', arg);\n              return;\n            }\n\n            settle(result.done ? 'return' : 'normal', arg);\n          },\n          function(err) {\n            resume('throw', err);\n          }\n        );\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case 'throw':\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {\n      return this;\n    };\n  }\n\n  _AsyncGenerator.prototype.next = function(arg) {\n    return this._invoke('next', arg);\n  };\n\n  _AsyncGenerator.prototype.throw = function(arg) {\n    return this._invoke('throw', arg);\n  };\n\n  _AsyncGenerator.prototype.return = function(arg) {\n    return this._invoke('return', arg);\n  };\n\n  function _wrapAsyncGenerator(fn) {\n    return function() {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n      waiting = false;\n\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function(resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function() {\n        return this;\n      };\n    }\n\n    iter.next = function(value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n\n      return pump('next', value);\n    };\n\n    if (typeof inner.throw === 'function') {\n      iter.throw = function(value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n\n        return pump('throw', value);\n      };\n    }\n\n    if (typeof inner.return === 'function') {\n      iter.return = function(value) {\n        return pump('return', value);\n      };\n    }\n\n    return iter;\n  }\n\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n\n  function _asyncToGenerator(fn) {\n    return function() {\n      var self = this,\n        args = arguments;\n      return new Promise(function(resolve, reject) {\n        var gen = fn.apply(self, args);\n\n        function _next(value) {\n          asyncGeneratorStep(\n            gen,\n            resolve,\n            reject,\n            _next,\n            _throw,\n            'next',\n            value\n          );\n        }\n\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n\n        _next(undefined);\n      });\n    };\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _extends() {\n    _extends =\n      Object.assign ||\n      function(target) {\n        for (var i = 1; i < arguments.length; i++) {\n          var source = arguments[i];\n\n          for (var key in source) {\n            if (Object.prototype.hasOwnProperty.call(source, key)) {\n              target[key] = source[key];\n            }\n          }\n        }\n\n        return target;\n      };\n\n    return _extends.apply(this, arguments);\n  }\n\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(\n          Object.getOwnPropertySymbols(source).filter(function(sym) {\n            return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n          })\n        );\n      }\n\n      ownKeys.forEach(function(key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n\n    return target;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf\n      ? Object.getPrototypeOf\n      : function _getPrototypeOf(o) {\n          return o.__proto__ || Object.getPrototypeOf(o);\n        };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf =\n      Object.setPrototypeOf ||\n      function _setPrototypeOf(o, p) {\n        o.__proto__ = p;\n        return o;\n      };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n\n    return _construct.apply(null, arguments);\n  }\n\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n\n      if (typeof Class !== 'function') {\n        throw new TypeError(\n          'Super expression must either be null or a function'\n        );\n      }\n\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n\n        _cache.set(Class, Wrapper);\n      }\n\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n\n    return _wrapNativeSuper(Class);\n  }\n\n  function _instanceof(left, right) {\n    if (\n      right != null &&\n      typeof Symbol !== 'undefined' &&\n      right[Symbol.hasInstance]\n    ) {\n      return right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule\n      ? obj\n      : {\n          default: obj\n        };\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc =\n              Object.defineProperty && Object.getOwnPropertyDescriptor\n                ? Object.getOwnPropertyDescriptor(obj, key)\n                : {};\n\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\n        \"this hasn't been initialised - super() hasn't been called\"\n      );\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n\n        var desc;\n\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n\n        return true;\n      };\n    }\n\n    return set(target, property, value, receiver);\n  }\n\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n\n    return value;\n  }\n\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    return Object.freeze(\n      Object.defineProperties(strings, {\n        raw: {\n          value: Object.freeze(raw)\n        }\n      })\n    );\n  }\n\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    strings.raw = raw;\n    return strings;\n  }\n\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n\n  function _classNameTDZError(name) {\n    throw new Error(\n      'Class \"' + name + '\" cannot be referenced in computed property keys.'\n    );\n  }\n\n  var _temporalUndefined = {};\n\n  function _slicedToArray(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimit(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _slicedToArrayLoose(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimitLoose(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return (\n      _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread()\n    );\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++)\n        arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (\n      Symbol.iterator in Object(iter) ||\n      Object.prototype.toString.call(iter) === '[object Arguments]'\n    )\n      return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (\n        var _i = arr[Symbol.iterator](), _s;\n        !(_n = (_s = _i.next()).done);\n        _n = true\n      ) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n\n    for (\n      var _iterator = arr[Symbol.iterator](), _step;\n      !(_step = _iterator.next()).done;\n\n    ) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n\n  function _skipFirstGeneratorNext(fn) {\n    return function() {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n\n    return (hint === 'string' ? String : Number)(input);\n  }\n\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n\n    return typeof key === 'symbol' ? key : String(key);\n  }\n\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error(\n      'Decorating class property failed. Please ensure that ' +\n        'proposal-class-properties is enabled and set to use loose mode. ' +\n        'To use proposal-class-properties in spec mode with decorators, wait for ' +\n        'the next major version of decorators in stage 2.'\n    );\n  }\n\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer\n        ? descriptor.initializer.call(context)\n        : void 0\n    });\n  }\n\n  function _applyDecoratedDescriptor(\n    target,\n    property,\n    decorators,\n    descriptor,\n    context\n  ) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function(key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n\n    desc = decorators\n      .slice()\n      .reverse()\n      .reduce(function(desc, decorator) {\n        return decorator(target, property, desc) || desc;\n      }, desc);\n\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n\n    return desc;\n  }\n\n  var id = 0;\n\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n\n    return receiver;\n  }\n\n  function _classPrivateFieldGet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n\n    return descriptor.value;\n  }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      descriptor.value = value;\n    }\n\n    return value;\n  }\n\n  function _classStaticPrivateFieldSpecGet(\n    receiver,\n    classConstructor,\n    descriptor\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return descriptor.value;\n  }\n\n  function _classStaticPrivateFieldSpecSet(\n    receiver,\n    classConstructor,\n    descriptor,\n    value\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n\n    descriptor.value = value;\n    return value;\n  }\n\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return method;\n  }\n\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(\n      _coalesceClassElements(r.d.map(_createElementDescriptor)),\n      decorators\n    );\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function() {\n      return api;\n    };\n\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function(O, elements) {\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function(F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            var placement = element.placement;\n\n            if (\n              element.kind === kind &&\n              (placement === 'static' || placement === 'prototype')\n            ) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function(receiver, element) {\n        var descriptor = element.descriptor;\n\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function(elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function(element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function(element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(\n            element,\n            placements\n          );\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function(element, placements, silent) {\n        var keys = placements[element.placement];\n\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n\n        keys.push(element.key);\n      },\n      decorateElement: function(element, placements) {\n        var extras = [];\n        var finishers = [];\n\n        for (\n          var decorators = element.decorators, i = decorators.length - 1;\n          i >= 0;\n          i--\n        ) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras(\n            (0, decorators[i])(elementObject) || elementObject\n          );\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n\n          var newExtras = elementFinisherExtras.extras;\n\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n\n            extras.push.apply(extras, newExtras);\n          }\n        }\n\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function(elements, decorators) {\n        var finishers = [];\n\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor(\n            (0, decorators[i])(obj) || obj\n          );\n\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (\n                  elements[j].key === elements[k].key &&\n                  elements[j].placement === elements[k].placement\n                ) {\n                  throw new TypeError(\n                    'Duplicated element (' + elements[j].key + ')'\n                  );\n                }\n              }\n            }\n          }\n        }\n\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function(element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function(elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function(elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(\n            elementObject,\n            'finisher',\n            'An element descriptor'\n          );\n          this.disallowProperty(\n            elementObject,\n            'extras',\n            'An element descriptor'\n          );\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function(elementObject) {\n        var kind = String(elementObject.kind);\n\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError(\n            'An element descriptor\\'s .kind property must be either \"method\" or' +\n              ' \"field\", but a decorator created an element descriptor with' +\n              ' .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        var key = _toPropertyKey(elementObject.key);\n\n        var placement = String(elementObject.placement);\n\n        if (\n          placement !== 'static' &&\n          placement !== 'prototype' &&\n          placement !== 'own'\n        ) {\n          throw new TypeError(\n            'An element descriptor\\'s .placement property must be one of \"static\",' +\n              ' \"prototype\" or \"own\", but a decorator created an element descriptor' +\n              ' with .placement \"' +\n              placement +\n              '\"'\n          );\n        }\n\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(\n          elementObject,\n          'elements',\n          'An element descriptor'\n        );\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n\n        if (kind !== 'field') {\n          this.disallowProperty(\n            elementObject,\n            'initializer',\n            'A method descriptor'\n          );\n        } else {\n          this.disallowProperty(\n            descriptor,\n            'get',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'set',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'value',\n            'The property descriptor of a field descriptor'\n          );\n          element.initializer = elementObject.initializer;\n        }\n\n        return element;\n      },\n      toElementFinisherExtras: function(elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function(elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function(obj) {\n        var kind = String(obj.kind);\n\n        if (kind !== 'class') {\n          throw new TypeError(\n            'A class descriptor\\'s .kind property must be \"class\", but a decorator' +\n              ' created a class descriptor with .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function(constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n\n            constructor = newConstructor;\n          }\n        }\n\n        return constructor;\n      },\n      disallowProperty: function(obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(\n            objectType + \" can't have a .\" + name + ' property.'\n          );\n        }\n      }\n    };\n    return api;\n  }\n\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n\n    var descriptor;\n\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static\n        ? 'static'\n        : def.kind === 'field'\n        ? 'own'\n        : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n\n    var isSameElement = function(other) {\n      return (\n        other.kind === 'method' &&\n        other.key === element.key &&\n        other.placement === element.placement\n      );\n    };\n\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n\n      if (\n        element.kind === 'method' &&\n        (other = newElements.find(isSameElement))\n      ) {\n        if (\n          _isDataDescriptor(element.descriptor) ||\n          _isDataDescriptor(other.descriptor)\n        ) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError(\n              'Duplicated methods (' + element.key + \") can't be decorated.\"\n            );\n          }\n\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\n                \"Decorators can't be placed on different accessors with for \" +\n                  'the same property (' +\n                  element.key +\n                  ').'\n              );\n            }\n\n            other.decorators = element.decorators;\n          }\n\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n\n    return newElements;\n  }\n\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n\n  function _isDataDescriptor(desc) {\n    return (\n      desc !== undefined &&\n      !(desc.value === undefined && desc.writable === undefined)\n    );\n  }\n\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n\n    return value;\n  }\n\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    return fn;\n  }\n\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function(re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n\n    var _RegExp = _wrapNativeSuper(RegExp);\n\n    var _super = RegExp.prototype;\n\n    var _groups = new WeakMap();\n\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n\n      _groups.set(_this, groups);\n\n      return _this;\n    }\n\n    _inherits(BabelRegExp, _RegExp);\n\n    BabelRegExp.prototype.exec = function(str) {\n      var result = _super.exec.call(this, str);\n\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n\n    BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n\n        return _super[Symbol.replace].call(\n          this,\n          str,\n          substitution.replace(/\\$<([^>]+)>/g, function(_, name) {\n            return '$' + groups[name];\n          })\n        );\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n\n        return _super[Symbol.replace].call(this, str, function() {\n          var args = [];\n          args.push.apply(args, arguments);\n\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n\n      return Object.keys(g).reduce(function(groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n\n    return _wrapRegExp.apply(this, arguments);\n  }\n\n  var vectorMultiply = function vectorMultiply(v, amount) {\n    return createVector(v.x * amount, v.y * amount);\n  };\n\n  var vectorAdd = function vectorAdd(a, b) {\n    return createVector(a.x + b.x, a.y + b.y);\n  };\n\n  var vectorNormalize = function vectorNormalize(v) {\n    var l = Math.sqrt(v.x * v.x + v.y * v.y);\n    if (l === 0) {\n      return {\n        x: 0,\n        y: 0\n      };\n    }\n    return createVector(v.x / l, v.y / l);\n  };\n\n  var vectorRotate = function vectorRotate(v, radians, origin) {\n    var cos = Math.cos(radians);\n    var sin = Math.sin(radians);\n    var t = createVector(v.x - origin.x, v.y - origin.y);\n    return createVector(\n      origin.x + cos * t.x - sin * t.y,\n      origin.y + sin * t.x + cos * t.y\n    );\n  };\n\n  var createVector = function createVector() {\n    var x =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    return { x: x, y: y };\n  };\n\n  var getMarkupValue = function getMarkupValue(value, size) {\n    var scalar =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var axis = arguments.length > 3 ? arguments[3] : undefined;\n    if (typeof value === 'string') {\n      return parseFloat(value) * scalar;\n    }\n    if (typeof value === 'number') {\n      return value * (axis ? size[axis] : Math.min(size.width, size.height));\n    }\n    return;\n  };\n\n  var getMarkupStyles = function getMarkupStyles(markup, size, scale) {\n    var lineStyle = markup.borderStyle || markup.lineStyle || 'solid';\n    var fill = markup.backgroundColor || markup.fontColor || 'transparent';\n    var stroke = markup.borderColor || markup.lineColor || 'transparent';\n    var strokeWidth = getMarkupValue(\n      markup.borderWidth || markup.lineWidth,\n      size,\n      scale\n    );\n    var lineCap = markup.lineCap || 'round';\n    var lineJoin = markup.lineJoin || 'round';\n    var dashes =\n      typeof lineStyle === 'string'\n        ? ''\n        : lineStyle\n            .map(function(v) {\n              return getMarkupValue(v, size, scale);\n            })\n            .join(',');\n    var opacity = markup.opacity || 1;\n    return {\n      'stroke-linecap': lineCap,\n      'stroke-linejoin': lineJoin,\n      'stroke-width': strokeWidth || 0,\n      'stroke-dasharray': dashes,\n      stroke: stroke,\n      fill: fill,\n      opacity: opacity\n    };\n  };\n\n  var isDefined = function isDefined(value) {\n    return value != null;\n  };\n\n  var getMarkupRect = function getMarkupRect(rect, size) {\n    var scalar =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n    var left =\n      getMarkupValue(rect.x, size, scalar, 'width') ||\n      getMarkupValue(rect.left, size, scalar, 'width');\n    var top =\n      getMarkupValue(rect.y, size, scalar, 'height') ||\n      getMarkupValue(rect.top, size, scalar, 'height');\n    var width = getMarkupValue(rect.width, size, scalar, 'width');\n    var height = getMarkupValue(rect.height, size, scalar, 'height');\n    var right = getMarkupValue(rect.right, size, scalar, 'width');\n    var bottom = getMarkupValue(rect.bottom, size, scalar, 'height');\n\n    if (!isDefined(top)) {\n      if (isDefined(height) && isDefined(bottom)) {\n        top = size.height - height - bottom;\n      } else {\n        top = bottom;\n      }\n    }\n\n    if (!isDefined(left)) {\n      if (isDefined(width) && isDefined(right)) {\n        left = size.width - width - right;\n      } else {\n        left = right;\n      }\n    }\n\n    if (!isDefined(width)) {\n      if (isDefined(left) && isDefined(right)) {\n        width = size.width - left - right;\n      } else {\n        width = 0;\n      }\n    }\n\n    if (!isDefined(height)) {\n      if (isDefined(top) && isDefined(bottom)) {\n        height = size.height - top - bottom;\n      } else {\n        height = 0;\n      }\n    }\n\n    return {\n      x: left || 0,\n      y: top || 0,\n      width: width || 0,\n      height: height || 0\n    };\n  };\n\n  var pointsToPathShape = function pointsToPathShape(points) {\n    return points\n      .map(function(point, index) {\n        return ''\n          .concat(index === 0 ? 'M' : 'L', ' ')\n          .concat(point.x, ' ')\n          .concat(point.y);\n      })\n      .join(' ');\n  };\n\n  var setAttributes = function setAttributes(element, attr) {\n    return Object.keys(attr).forEach(function(key) {\n      return element.setAttribute(key, attr[key]);\n    });\n  };\n\n  var ns = 'http://www.w3.org/2000/svg';\n  var svg = function svg(tag, attr) {\n    var element = document.createElementNS(ns, tag);\n    if (attr) {\n      setAttributes(element, attr);\n    }\n    return element;\n  };\n\n  var updateRect = function updateRect(element) {\n    return setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles)\n    );\n  };\n\n  var updateEllipse = function updateEllipse(element) {\n    var cx = element.rect.x + element.rect.width * 0.5;\n    var cy = element.rect.y + element.rect.height * 0.5;\n    var rx = element.rect.width * 0.5;\n    var ry = element.rect.height * 0.5;\n    return setAttributes(\n      element,\n      Object.assign(\n        {\n          cx: cx,\n          cy: cy,\n          rx: rx,\n          ry: ry\n        },\n        element.styles\n      )\n    );\n  };\n\n  var IMAGE_FIT_STYLE = {\n    contain: 'xMidYMid meet',\n    cover: 'xMidYMid slice'\n  };\n\n  var updateImage = function updateImage(element, markup) {\n    setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles, {\n        preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || 'none'\n      })\n    );\n  };\n\n  var TEXT_ANCHOR = {\n    left: 'start',\n    center: 'middle',\n    right: 'end'\n  };\n\n  var updateText = function updateText(element, markup, size, scale) {\n    var fontSize = getMarkupValue(markup.fontSize, size, scale);\n    var fontFamily = markup.fontFamily || 'sans-serif';\n    var fontWeight = markup.fontWeight || 'normal';\n    var textAlign = TEXT_ANCHOR[markup.textAlign] || 'start';\n\n    setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles, {\n        'stroke-width': 0,\n        'font-weight': fontWeight,\n        'font-size': fontSize,\n        'font-family': fontFamily,\n        'text-anchor': textAlign\n      })\n    );\n\n    // update text\n    if (element.text !== markup.text) {\n      element.text = markup.text;\n      element.textContent = markup.text.length ? markup.text : ' ';\n    }\n  };\n\n  var updateLine = function updateLine(element, markup, size, scale) {\n    setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles, {\n        fill: 'none'\n      })\n    );\n\n    var line = element.childNodes[0];\n    var begin = element.childNodes[1];\n    var end = element.childNodes[2];\n\n    var origin = element.rect;\n\n    var target = {\n      x: element.rect.x + element.rect.width,\n      y: element.rect.y + element.rect.height\n    };\n\n    setAttributes(line, {\n      x1: origin.x,\n      y1: origin.y,\n      x2: target.x,\n      y2: target.y\n    });\n\n    if (!markup.lineDecoration) return;\n\n    begin.style.display = 'none';\n    end.style.display = 'none';\n\n    var v = vectorNormalize({\n      x: target.x - origin.x,\n      y: target.y - origin.y\n    });\n\n    var l = getMarkupValue(0.05, size, scale);\n\n    if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n      var arrowBeginRotationPoint = vectorMultiply(v, l);\n      var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n      var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n      var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n\n      setAttributes(begin, {\n        style: 'display:block;',\n        d: 'M'\n          .concat(arrowBeginA.x, ',')\n          .concat(arrowBeginA.y, ' L')\n          .concat(origin.x, ',')\n          .concat(origin.y, ' L')\n          .concat(arrowBeginB.x, ',')\n          .concat(arrowBeginB.y)\n      });\n    }\n\n    if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n      var arrowEndRotationPoint = vectorMultiply(v, -l);\n      var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n      var arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n      var arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n\n      setAttributes(end, {\n        style: 'display:block;',\n        d: 'M'\n          .concat(arrowEndA.x, ',')\n          .concat(arrowEndA.y, ' L')\n          .concat(target.x, ',')\n          .concat(target.y, ' L')\n          .concat(arrowEndB.x, ',')\n          .concat(arrowEndB.y)\n      });\n    }\n  };\n\n  var updatePath = function updatePath(element, markup, size, scale) {\n    setAttributes(\n      element,\n      Object.assign({}, element.styles, {\n        fill: 'none',\n        d: pointsToPathShape(\n          markup.points.map(function(point) {\n            return {\n              x: getMarkupValue(point.x, size, scale, 'width'),\n              y: getMarkupValue(point.y, size, scale, 'height')\n            };\n          })\n        )\n      })\n    );\n  };\n\n  var createShape = function createShape(node) {\n    return function(markup) {\n      return svg(node, { id: markup.id });\n    };\n  };\n\n  var createImage = function createImage(markup) {\n    var shape = svg('image', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round',\n      opacity: '0'\n    });\n\n    shape.onload = function() {\n      shape.setAttribute('opacity', markup.opacity || 1);\n    };\n    shape.setAttributeNS(\n      'http://www.w3.org/1999/xlink',\n      'xlink:href',\n      markup.src\n    );\n    return shape;\n  };\n\n  var createLine = function createLine(markup) {\n    var shape = svg('g', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round'\n    });\n\n    var line = svg('line');\n    shape.appendChild(line);\n\n    var begin = svg('path');\n    shape.appendChild(begin);\n\n    var end = svg('path');\n    shape.appendChild(end);\n\n    return shape;\n  };\n\n  var CREATE_TYPE_ROUTES = {\n    image: createImage,\n    rect: createShape('rect'),\n    ellipse: createShape('ellipse'),\n    text: createShape('text'),\n    path: createShape('path'),\n    line: createLine\n  };\n\n  var UPDATE_TYPE_ROUTES = {\n    rect: updateRect,\n    ellipse: updateEllipse,\n    image: updateImage,\n    text: updateText,\n    path: updatePath,\n    line: updateLine\n  };\n\n  var createMarkupByType = function createMarkupByType(type, markup) {\n    return CREATE_TYPE_ROUTES[type](markup);\n  };\n\n  var updateMarkupByType = function updateMarkupByType(\n    element,\n    type,\n    markup,\n    size,\n    scale\n  ) {\n    if (type !== 'path') {\n      element.rect = getMarkupRect(markup, size, scale);\n    }\n    element.styles = getMarkupStyles(markup, size, scale);\n    UPDATE_TYPE_ROUTES[type](element, markup, size, scale);\n  };\n\n  var MARKUP_RECT = [\n    'x',\n    'y',\n    'left',\n    'top',\n    'right',\n    'bottom',\n    'width',\n    'height'\n  ];\n\n  var toOptionalFraction = function toOptionalFraction(value) {\n    return typeof value === 'string' && /%/.test(value)\n      ? parseFloat(value) / 100\n      : value;\n  };\n\n  // adds default markup properties, clones markup\n  var prepareMarkup = function prepareMarkup(markup) {\n    var _markup = _slicedToArray(markup, 2),\n      type = _markup[0],\n      props = _markup[1];\n\n    var rect = props.points\n      ? {}\n      : MARKUP_RECT.reduce(function(prev, curr) {\n          prev[curr] = toOptionalFraction(props[curr]);\n          return prev;\n        }, {});\n\n    return [\n      type,\n      Object.assign(\n        {\n          zIndex: 0\n        },\n        props,\n        rect\n      )\n    ];\n  };\n\n  var sortMarkupByZIndex = function sortMarkupByZIndex(a, b) {\n    if (a[1].zIndex > b[1].zIndex) {\n      return 1;\n    }\n    if (a[1].zIndex < b[1].zIndex) {\n      return -1;\n    }\n    return 0;\n  };\n\n  var createMarkupView = function createMarkupView(_) {\n    return _.utils.createView({\n      name: 'image-preview-markup',\n      tag: 'svg',\n      ignoreRect: true,\n      mixins: {\n        apis: ['width', 'height', 'crop', 'markup', 'resize', 'dirty']\n      },\n\n      write: function write(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n\n        if (!props.dirty) return;\n        var crop = props.crop,\n          resize = props.resize,\n          markup = props.markup;\n\n        var viewWidth = props.width;\n        var viewHeight = props.height;\n\n        var cropWidth = crop.width;\n        var cropHeight = crop.height;\n\n        if (resize) {\n          var _size = resize.size;\n\n          var outputWidth = _size && _size.width;\n          var outputHeight = _size && _size.height;\n          var outputFit = resize.mode;\n          var outputUpscale = resize.upscale;\n\n          if (outputWidth && !outputHeight) outputHeight = outputWidth;\n          if (outputHeight && !outputWidth) outputWidth = outputHeight;\n\n          var shouldUpscale =\n            cropWidth < outputWidth && cropHeight < outputHeight;\n\n          if (!shouldUpscale || (shouldUpscale && outputUpscale)) {\n            var scalarWidth = outputWidth / cropWidth;\n            var scalarHeight = outputHeight / cropHeight;\n\n            if (outputFit === 'force') {\n              cropWidth = outputWidth;\n              cropHeight = outputHeight;\n            } else {\n              var scalar;\n              if (outputFit === 'cover') {\n                scalar = Math.max(scalarWidth, scalarHeight);\n              } else if (outputFit === 'contain') {\n                scalar = Math.min(scalarWidth, scalarHeight);\n              }\n              cropWidth = cropWidth * scalar;\n              cropHeight = cropHeight * scalar;\n            }\n          }\n        }\n\n        var size = {\n          width: viewWidth,\n          height: viewHeight\n        };\n\n        root.element.setAttribute('width', size.width);\n        root.element.setAttribute('height', size.height);\n\n        var scale = Math.min(viewWidth / cropWidth, viewHeight / cropHeight);\n\n        // clear\n        root.element.innerHTML = '';\n\n        // get filter\n        var markupFilter = root.query('GET_IMAGE_PREVIEW_MARKUP_FILTER');\n\n        // draw new\n        markup\n          .filter(markupFilter)\n          .map(prepareMarkup)\n          .sort(sortMarkupByZIndex)\n          .forEach(function(markup) {\n            var _markup = _slicedToArray(markup, 2),\n              type = _markup[0],\n              settings = _markup[1];\n\n            // create\n            var element = createMarkupByType(type, settings);\n\n            // update\n            updateMarkupByType(element, type, settings, size, scale);\n\n            // add\n            root.element.appendChild(element);\n          });\n      }\n    });\n  };\n\n  var createVector$1 = function createVector(x, y) {\n    return { x: x, y: y };\n  };\n\n  var vectorDot = function vectorDot(a, b) {\n    return a.x * b.x + a.y * b.y;\n  };\n\n  var vectorSubtract = function vectorSubtract(a, b) {\n    return createVector$1(a.x - b.x, a.y - b.y);\n  };\n\n  var vectorDistanceSquared = function vectorDistanceSquared(a, b) {\n    return vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));\n  };\n\n  var vectorDistance = function vectorDistance(a, b) {\n    return Math.sqrt(vectorDistanceSquared(a, b));\n  };\n\n  var getOffsetPointOnEdge = function getOffsetPointOnEdge(length, rotation) {\n    var a = length;\n\n    var A = 1.5707963267948966;\n    var B = rotation;\n    var C = 1.5707963267948966 - rotation;\n\n    var sinA = Math.sin(A);\n    var sinB = Math.sin(B);\n    var sinC = Math.sin(C);\n    var cosC = Math.cos(C);\n    var ratio = a / sinA;\n    var b = ratio * sinB;\n    var c = ratio * sinC;\n\n    return createVector$1(cosC * b, cosC * c);\n  };\n\n  var getRotatedRectSize = function getRotatedRectSize(rect, rotation) {\n    var w = rect.width;\n    var h = rect.height;\n\n    var hor = getOffsetPointOnEdge(w, rotation);\n    var ver = getOffsetPointOnEdge(h, rotation);\n\n    var tl = createVector$1(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));\n\n    var tr = createVector$1(\n      rect.x + rect.width + Math.abs(ver.y),\n      rect.y + Math.abs(ver.x)\n    );\n\n    var bl = createVector$1(\n      rect.x - Math.abs(ver.y),\n      rect.y + rect.height - Math.abs(ver.x)\n    );\n\n    return {\n      width: vectorDistance(tl, tr),\n      height: vectorDistance(tl, bl)\n    };\n  };\n\n  var calculateCanvasSize = function calculateCanvasSize(\n    image,\n    canvasAspectRatio\n  ) {\n    var zoom =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n    var imageAspectRatio = image.height / image.width;\n\n    // determine actual pixels on x and y axis\n    var canvasWidth = 1;\n    var canvasHeight = canvasAspectRatio;\n    var imgWidth = 1;\n    var imgHeight = imageAspectRatio;\n    if (imgHeight > canvasHeight) {\n      imgHeight = canvasHeight;\n      imgWidth = imgHeight / imageAspectRatio;\n    }\n\n    var scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);\n    var width = image.width / (zoom * scalar * imgWidth);\n    var height = width * canvasAspectRatio;\n\n    return {\n      width: width,\n      height: height\n    };\n  };\n\n  var getImageRectZoomFactor = function getImageRectZoomFactor(\n    imageRect,\n    cropRect,\n    rotation,\n    center\n  ) {\n    // calculate available space round image center position\n    var cx = center.x > 0.5 ? 1 - center.x : center.x;\n    var cy = center.y > 0.5 ? 1 - center.y : center.y;\n    var imageWidth = cx * 2 * imageRect.width;\n    var imageHeight = cy * 2 * imageRect.height;\n\n    // calculate rotated crop rectangle size\n    var rotatedCropSize = getRotatedRectSize(cropRect, rotation);\n\n    // calculate scalar required to fit image\n    return Math.max(\n      rotatedCropSize.width / imageWidth,\n      rotatedCropSize.height / imageHeight\n    );\n  };\n\n  var getCenteredCropRect = function getCenteredCropRect(\n    container,\n    aspectRatio\n  ) {\n    var width = container.width;\n    var height = width * aspectRatio;\n    if (height > container.height) {\n      height = container.height;\n      width = height / aspectRatio;\n    }\n    var x = (container.width - width) * 0.5;\n    var y = (container.height - height) * 0.5;\n\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  };\n\n  var getCurrentCropSize = function getCurrentCropSize(imageSize) {\n    var crop =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var zoom = crop.zoom,\n      rotation = crop.rotation,\n      center = crop.center,\n      aspectRatio = crop.aspectRatio;\n\n    if (!aspectRatio) aspectRatio = imageSize.height / imageSize.width;\n\n    var canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n\n    var canvasCenter = {\n      x: canvasSize.width * 0.5,\n      y: canvasSize.height * 0.5\n    };\n\n    var stage = {\n      x: 0,\n      y: 0,\n      width: canvasSize.width,\n      height: canvasSize.height,\n      center: canvasCenter\n    };\n\n    var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n    var stageZoomFactor = getImageRectZoomFactor(\n      imageSize,\n      getCenteredCropRect(stage, aspectRatio),\n      rotation,\n      shouldLimit ? center : { x: 0.5, y: 0.5 }\n    );\n\n    var scale = zoom * stageZoomFactor;\n\n    // start drawing\n    return {\n      widthFloat: canvasSize.width / scale,\n      heightFloat: canvasSize.height / scale,\n      width: Math.round(canvasSize.width / scale),\n      height: Math.round(canvasSize.height / scale)\n    };\n  };\n\n  var IMAGE_SCALE_SPRING_PROPS = {\n    type: 'spring',\n    stiffness: 0.5,\n    damping: 0.45,\n    mass: 10\n  };\n\n  // does horizontal and vertical flipping\n  var createBitmapView = function createBitmapView(_) {\n    return _.utils.createView({\n      name: 'image-bitmap',\n      ignoreRect: true,\n      mixins: { styles: ['scaleX', 'scaleY'] },\n      create: function create(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        root.appendChild(props.image);\n      }\n    });\n  };\n\n  // shifts and rotates image\n  var createImageCanvasWrapper = function createImageCanvasWrapper(_) {\n    return _.utils.createView({\n      name: 'image-canvas-wrapper',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['crop', 'width', 'height'],\n\n        styles: [\n          'originX',\n          'originY',\n          'translateX',\n          'translateY',\n          'scaleX',\n          'scaleY',\n          'rotateZ'\n        ],\n\n        animations: {\n          originX: IMAGE_SCALE_SPRING_PROPS,\n          originY: IMAGE_SCALE_SPRING_PROPS,\n          scaleX: IMAGE_SCALE_SPRING_PROPS,\n          scaleY: IMAGE_SCALE_SPRING_PROPS,\n          translateX: IMAGE_SCALE_SPRING_PROPS,\n          translateY: IMAGE_SCALE_SPRING_PROPS,\n          rotateZ: IMAGE_SCALE_SPRING_PROPS\n        }\n      },\n\n      create: function create(_ref2) {\n        var root = _ref2.root,\n          props = _ref2.props;\n        props.width = props.image.width;\n        props.height = props.image.height;\n        root.ref.bitmap = root.appendChildView(\n          root.createChildView(createBitmapView(_), { image: props.image })\n        );\n      },\n      write: function write(_ref3) {\n        var root = _ref3.root,\n          props = _ref3.props;\n        var flip = props.crop.flip;\n        var bitmap = root.ref.bitmap;\n        bitmap.scaleX = flip.horizontal ? -1 : 1;\n        bitmap.scaleY = flip.vertical ? -1 : 1;\n      }\n    });\n  };\n\n  // clips canvas to correct aspect ratio\n  var createClipView = function createClipView(_) {\n    return _.utils.createView({\n      name: 'image-clip',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: [\n          'crop',\n          'markup',\n          'resize',\n          'width',\n          'height',\n          'dirty',\n          'background'\n        ],\n\n        styles: ['width', 'height', 'opacity'],\n        animations: {\n          opacity: { type: 'tween', duration: 250 }\n        }\n      },\n\n      didWriteView: function didWriteView(_ref4) {\n        var root = _ref4.root,\n          props = _ref4.props;\n        if (!props.background) return;\n        root.element.style.backgroundColor = props.background;\n      },\n      create: function create(_ref5) {\n        var root = _ref5.root,\n          props = _ref5.props;\n\n        root.ref.image = root.appendChildView(\n          root.createChildView(\n            createImageCanvasWrapper(_),\n            Object.assign({}, props)\n          )\n        );\n\n        root.ref.createMarkup = function() {\n          if (root.ref.markup) return;\n          root.ref.markup = root.appendChildView(\n            root.createChildView(createMarkupView(_), Object.assign({}, props))\n          );\n        };\n\n        root.ref.destroyMarkup = function() {\n          if (!root.ref.markup) return;\n          root.removeChildView(root.ref.markup);\n          root.ref.markup = null;\n        };\n\n        // set up transparency grid\n        var transparencyIndicator = root.query(\n          'GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR'\n        );\n        if (transparencyIndicator === null) return;\n\n        // grid pattern\n        if (transparencyIndicator === 'grid') {\n          root.element.dataset.transparencyIndicator = transparencyIndicator;\n        }\n        // basic color\n        else {\n          root.element.dataset.transparencyIndicator = 'color';\n        }\n      },\n      write: function write(_ref6) {\n        var root = _ref6.root,\n          props = _ref6.props,\n          shouldOptimize = _ref6.shouldOptimize;\n        var crop = props.crop,\n          markup = props.markup,\n          resize = props.resize,\n          dirty = props.dirty,\n          width = props.width,\n          height = props.height;\n\n        root.ref.image.crop = crop;\n\n        var stage = {\n          x: 0,\n          y: 0,\n          width: width,\n          height: height,\n          center: {\n            x: width * 0.5,\n            y: height * 0.5\n          }\n        };\n\n        var image = {\n          width: root.ref.image.width,\n          height: root.ref.image.height\n        };\n\n        var origin = {\n          x: crop.center.x * image.width,\n          y: crop.center.y * image.height\n        };\n\n        var translation = {\n          x: stage.center.x - image.width * crop.center.x,\n          y: stage.center.y - image.height * crop.center.y\n        };\n\n        var rotation = Math.PI * 2 + (crop.rotation % (Math.PI * 2));\n\n        var cropAspectRatio = crop.aspectRatio || image.height / image.width;\n\n        var shouldLimit =\n          typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n        var stageZoomFactor = getImageRectZoomFactor(\n          image,\n          getCenteredCropRect(stage, cropAspectRatio),\n\n          rotation,\n          shouldLimit ? crop.center : { x: 0.5, y: 0.5 }\n        );\n\n        var scale = crop.zoom * stageZoomFactor;\n\n        // update markup view\n        if (markup && markup.length) {\n          root.ref.createMarkup();\n          root.ref.markup.width = width;\n          root.ref.markup.height = height;\n          root.ref.markup.resize = resize;\n          root.ref.markup.dirty = dirty;\n          root.ref.markup.markup = markup;\n          root.ref.markup.crop = getCurrentCropSize(image, crop);\n        } else if (root.ref.markup) {\n          root.ref.destroyMarkup();\n        }\n\n        // update image view\n        var imageView = root.ref.image;\n\n        // don't update clip layout\n        if (shouldOptimize) {\n          imageView.originX = null;\n          imageView.originY = null;\n          imageView.translateX = null;\n          imageView.translateY = null;\n          imageView.rotateZ = null;\n          imageView.scaleX = null;\n          imageView.scaleY = null;\n          return;\n        }\n\n        imageView.originX = origin.x;\n        imageView.originY = origin.y;\n        imageView.translateX = translation.x;\n        imageView.translateY = translation.y;\n        imageView.rotateZ = rotation;\n        imageView.scaleX = scale;\n        imageView.scaleY = scale;\n      }\n    });\n  };\n\n  var createImageView = function createImageView(_) {\n    return _.utils.createView({\n      name: 'image-preview',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['image', 'crop', 'markup', 'resize', 'dirty', 'background'],\n\n        styles: ['translateY', 'scaleX', 'scaleY', 'opacity'],\n\n        animations: {\n          scaleX: IMAGE_SCALE_SPRING_PROPS,\n          scaleY: IMAGE_SCALE_SPRING_PROPS,\n          translateY: IMAGE_SCALE_SPRING_PROPS,\n          opacity: { type: 'tween', duration: 400 }\n        }\n      },\n\n      create: function create(_ref7) {\n        var root = _ref7.root,\n          props = _ref7.props;\n        root.ref.clip = root.appendChildView(\n          root.createChildView(createClipView(_), {\n            id: props.id,\n            image: props.image,\n            crop: props.crop,\n            markup: props.markup,\n            resize: props.resize,\n            dirty: props.dirty,\n            background: props.background\n          })\n        );\n      },\n      write: function write(_ref8) {\n        var root = _ref8.root,\n          props = _ref8.props,\n          shouldOptimize = _ref8.shouldOptimize;\n        var clip = root.ref.clip;\n        var image = props.image,\n          crop = props.crop,\n          markup = props.markup,\n          resize = props.resize,\n          dirty = props.dirty;\n\n        clip.crop = crop;\n        clip.markup = markup;\n        clip.resize = resize;\n        clip.dirty = dirty;\n\n        // don't update clip layout\n        clip.opacity = shouldOptimize ? 0 : 1;\n\n        // don't re-render if optimizing or hidden (width will be zero resulting in weird animations)\n        if (shouldOptimize || root.rect.element.hidden) return;\n\n        // calculate scaled preview image size\n        var imageAspectRatio = image.height / image.width;\n        var aspectRatio = crop.aspectRatio || imageAspectRatio;\n\n        // calculate container size\n        var containerWidth = root.rect.inner.width;\n        var containerHeight = root.rect.inner.height;\n\n        var fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        var minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n        var maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n\n        var panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n        var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n\n        if (panelAspectRatio && !allowMultiple) {\n          fixedPreviewHeight = containerWidth * panelAspectRatio;\n          aspectRatio = panelAspectRatio;\n        }\n\n        // determine clip width and height\n        var clipHeight =\n          fixedPreviewHeight !== null\n            ? fixedPreviewHeight\n            : Math.max(\n                minPreviewHeight,\n                Math.min(containerWidth * aspectRatio, maxPreviewHeight)\n              );\n\n        var clipWidth = clipHeight / aspectRatio;\n        if (clipWidth > containerWidth) {\n          clipWidth = containerWidth;\n          clipHeight = clipWidth * aspectRatio;\n        }\n\n        if (clipHeight > containerHeight) {\n          clipHeight = containerHeight;\n          clipWidth = containerHeight / aspectRatio;\n        }\n\n        clip.width = clipWidth;\n        clip.height = clipHeight;\n      }\n    });\n  };\n\n  var SVG_MASK =\n    '<svg width=\"500\" height=\"200\" viewBox=\"0 0 500 200\" preserveAspectRatio=\"none\">\\n    <defs>\\n        <radialGradient id=\"gradient-__UID__\" cx=\".5\" cy=\"1.25\" r=\"1.15\">\\n            <stop offset=\\'50%\\' stop-color=\\'#000000\\'/>\\n            <stop offset=\\'56%\\' stop-color=\\'#0a0a0a\\'/>\\n            <stop offset=\\'63%\\' stop-color=\\'#262626\\'/>\\n            <stop offset=\\'69%\\' stop-color=\\'#4f4f4f\\'/>\\n            <stop offset=\\'75%\\' stop-color=\\'#808080\\'/>\\n            <stop offset=\\'81%\\' stop-color=\\'#b1b1b1\\'/>\\n            <stop offset=\\'88%\\' stop-color=\\'#dadada\\'/>\\n            <stop offset=\\'94%\\' stop-color=\\'#f6f6f6\\'/>\\n            <stop offset=\\'100%\\' stop-color=\\'#ffffff\\'/>\\n        </radialGradient>\\n        <mask id=\"mask-__UID__\">\\n            <rect x=\"0\" y=\"0\" width=\"500\" height=\"200\" fill=\"url(#gradient-__UID__)\"></rect>\\n        </mask>\\n    </defs>\\n    <rect x=\"0\" width=\"500\" height=\"200\" fill=\"currentColor\" mask=\"url(#mask-__UID__)\"></rect>\\n</svg>';\n\n  var SVGMaskUniqueId = 0;\n\n  var createImageOverlayView = function createImageOverlayView(fpAPI) {\n    return fpAPI.utils.createView({\n      name: 'image-preview-overlay',\n      tag: 'div',\n      ignoreRect: true,\n      create: function create(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        var mask = SVG_MASK;\n        if (document.querySelector('base')) {\n          var url = new URL(\n            window.location.href.replace(window.location.hash, '')\n          ).href;\n          mask = mask.replace(/url\\(\\#/g, 'url(' + url + '#');\n        }\n\n        SVGMaskUniqueId++;\n        root.element.classList.add(\n          'filepond--image-preview-overlay-'.concat(props.status)\n        );\n\n        root.element.innerHTML = mask.replace(/__UID__/g, SVGMaskUniqueId);\n      },\n      mixins: {\n        styles: ['opacity'],\n        animations: {\n          opacity: { type: 'spring', mass: 25 }\n        }\n      }\n    });\n  };\n\n  /**\n   * Bitmap Worker\n   */\n  var BitmapWorker = function BitmapWorker() {\n    self.onmessage = function(e) {\n      createImageBitmap(e.data.message.file).then(function(bitmap) {\n        self.postMessage({ id: e.data.id, message: bitmap }, [bitmap]);\n      });\n    };\n  };\n\n  /**\n   * ColorMatrix Worker\n   */\n  var ColorMatrixWorker = function ColorMatrixWorker() {\n    self.onmessage = function(e) {\n      var imageData = e.data.message.imageData;\n      var matrix = e.data.message.colorMatrix;\n\n      var data = imageData.data;\n      var l = data.length;\n\n      var m11 = matrix[0];\n      var m12 = matrix[1];\n      var m13 = matrix[2];\n      var m14 = matrix[3];\n      var m15 = matrix[4];\n\n      var m21 = matrix[5];\n      var m22 = matrix[6];\n      var m23 = matrix[7];\n      var m24 = matrix[8];\n      var m25 = matrix[9];\n\n      var m31 = matrix[10];\n      var m32 = matrix[11];\n      var m33 = matrix[12];\n      var m34 = matrix[13];\n      var m35 = matrix[14];\n\n      var m41 = matrix[15];\n      var m42 = matrix[16];\n      var m43 = matrix[17];\n      var m44 = matrix[18];\n      var m45 = matrix[19];\n\n      var index = 0,\n        r = 0.0,\n        g = 0.0,\n        b = 0.0,\n        a = 0.0;\n\n      for (; index < l; index += 4) {\n        r = data[index] / 255;\n        g = data[index + 1] / 255;\n        b = data[index + 2] / 255;\n        a = data[index + 3] / 255;\n        data[index] = Math.max(\n          0,\n          Math.min((r * m11 + g * m12 + b * m13 + a * m14 + m15) * 255, 255)\n        );\n        data[index + 1] = Math.max(\n          0,\n          Math.min((r * m21 + g * m22 + b * m23 + a * m24 + m25) * 255, 255)\n        );\n        data[index + 2] = Math.max(\n          0,\n          Math.min((r * m31 + g * m32 + b * m33 + a * m34 + m35) * 255, 255)\n        );\n        data[index + 3] = Math.max(\n          0,\n          Math.min((r * m41 + g * m42 + b * m43 + a * m44 + m45) * 255, 255)\n        );\n      }\n\n      self.postMessage({ id: e.data.id, message: imageData }, [\n        imageData.data.buffer\n      ]);\n    };\n  };\n\n  var getImageSize = function getImageSize(url, cb) {\n    var image = new Image();\n    image.onload = function() {\n      var width = image.naturalWidth;\n      var height = image.naturalHeight;\n      image = null;\n      cb(width, height);\n    };\n    image.src = url;\n  };\n\n  var transforms = {\n    1: function _() {\n      return [1, 0, 0, 1, 0, 0];\n    },\n    2: function _(width) {\n      return [-1, 0, 0, 1, width, 0];\n    },\n    3: function _(width, height) {\n      return [-1, 0, 0, -1, width, height];\n    },\n    4: function _(width, height) {\n      return [1, 0, 0, -1, 0, height];\n    },\n    5: function _() {\n      return [0, 1, 1, 0, 0, 0];\n    },\n    6: function _(width, height) {\n      return [0, 1, -1, 0, height, 0];\n    },\n    7: function _(width, height) {\n      return [0, -1, -1, 0, height, width];\n    },\n    8: function _(width) {\n      return [0, -1, 1, 0, 0, width];\n    }\n  };\n\n  var fixImageOrientation = function fixImageOrientation(\n    ctx,\n    width,\n    height,\n    orientation\n  ) {\n    // no orientation supplied\n    if (orientation === -1) {\n      return;\n    }\n\n    ctx.transform.apply(ctx, transforms[orientation](width, height));\n  };\n\n  // draws the preview image to canvas\n  var createPreviewImage = function createPreviewImage(\n    data,\n    width,\n    height,\n    orientation\n  ) {\n    // can't draw on half pixels\n    width = Math.round(width);\n    height = Math.round(height);\n\n    // draw image\n    var canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    var ctx = canvas.getContext('2d');\n\n    // if is rotated incorrectly swap width and height\n    if (orientation >= 5 && orientation <= 8) {\n      var _ref = [height, width];\n      width = _ref[0];\n      height = _ref[1];\n    }\n\n    // correct image orientation\n    fixImageOrientation(ctx, width, height, orientation);\n\n    // draw the image\n    ctx.drawImage(data, 0, 0, width, height);\n\n    return canvas;\n  };\n\n  var isBitmap = function isBitmap(file) {\n    return /^image/.test(file.type) && !/svg/.test(file.type);\n  };\n\n  var MAX_WIDTH = 10;\n  var MAX_HEIGHT = 10;\n\n  var calculateAverageColor = function calculateAverageColor(image) {\n    var scalar = Math.min(MAX_WIDTH / image.width, MAX_HEIGHT / image.height);\n\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n    var width = (canvas.width = Math.ceil(image.width * scalar));\n    var height = (canvas.height = Math.ceil(image.height * scalar));\n    ctx.drawImage(image, 0, 0, width, height);\n    var data = null;\n    try {\n      data = ctx.getImageData(0, 0, width, height).data;\n    } catch (e) {\n      return null;\n    }\n    var l = data.length;\n\n    var r = 0;\n    var g = 0;\n    var b = 0;\n    var i = 0;\n\n    for (; i < l; i += 4) {\n      r += data[i] * data[i];\n      g += data[i + 1] * data[i + 1];\n      b += data[i + 2] * data[i + 2];\n    }\n\n    r = averageColor(r, l);\n    g = averageColor(g, l);\n    b = averageColor(b, l);\n\n    return { r: r, g: g, b: b };\n  };\n\n  var averageColor = function averageColor(c, l) {\n    return Math.floor(Math.sqrt(c / (l / 4)));\n  };\n\n  var cloneCanvas = function cloneCanvas(origin, target) {\n    target = target || document.createElement('canvas');\n    target.width = origin.width;\n    target.height = origin.height;\n    var ctx = target.getContext('2d');\n    ctx.drawImage(origin, 0, 0);\n    return target;\n  };\n\n  var cloneImageData = function cloneImageData(imageData) {\n    var id;\n    try {\n      id = new ImageData(imageData.width, imageData.height);\n    } catch (e) {\n      var canvas = document.createElement('canvas');\n      var ctx = canvas.getContext('2d');\n      id = ctx.createImageData(imageData.width, imageData.height);\n    }\n    id.data.set(new Uint8ClampedArray(imageData.data));\n    return id;\n  };\n\n  var loadImage = function loadImage(url) {\n    return new Promise(function(resolve, reject) {\n      var img = new Image();\n      img.crossOrigin = 'Anonymous';\n      img.onload = function() {\n        resolve(img);\n      };\n      img.onerror = function(e) {\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n\n  var createImageWrapperView = function createImageWrapperView(_) {\n    // create overlay view\n    var OverlayView = createImageOverlayView(_);\n\n    var ImageView = createImageView(_);\n    var createWorker = _.utils.createWorker;\n\n    var applyFilter = function applyFilter(root, filter, target) {\n      return new Promise(function(resolve) {\n        // will store image data for future filter updates\n        if (!root.ref.imageData) {\n          root.ref.imageData = target\n            .getContext('2d')\n            .getImageData(0, 0, target.width, target.height);\n        }\n\n        // get image data reference\n        var imageData = cloneImageData(root.ref.imageData);\n\n        if (!filter || filter.length !== 20) {\n          target.getContext('2d').putImageData(imageData, 0, 0);\n          return resolve();\n        }\n\n        var worker = createWorker(ColorMatrixWorker);\n        worker.post(\n          {\n            imageData: imageData,\n            colorMatrix: filter\n          },\n\n          function(response) {\n            // apply filtered colors\n            target.getContext('2d').putImageData(response, 0, 0);\n\n            // stop worker\n            worker.terminate();\n\n            // done!\n            resolve();\n          },\n          [imageData.data.buffer]\n        );\n      });\n    };\n\n    var removeImageView = function removeImageView(root, imageView) {\n      root.removeChildView(imageView);\n      imageView.image.width = 1;\n      imageView.image.height = 1;\n      imageView._destroy();\n    };\n\n    // remove an image\n    var shiftImage = function shiftImage(_ref) {\n      var root = _ref.root;\n      var imageView = root.ref.images.shift();\n      imageView.opacity = 0;\n      imageView.translateY = -15;\n      root.ref.imageViewBin.push(imageView);\n      return imageView;\n    };\n\n    // add new image\n    var pushImage = function pushImage(_ref2) {\n      var root = _ref2.root,\n        props = _ref2.props,\n        image = _ref2.image;\n      var id = props.id;\n      var item = root.query('GET_ITEM', { id: id });\n      if (!item) return;\n\n      var crop = item.getMetadata('crop') || {\n        center: {\n          x: 0.5,\n          y: 0.5\n        },\n\n        flip: {\n          horizontal: false,\n          vertical: false\n        },\n\n        zoom: 1,\n        rotation: 0,\n        aspectRatio: null\n      };\n\n      var background = root.query(\n        'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n      );\n\n      var markup;\n      var resize;\n      var dirty = false;\n      if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n        markup = item.getMetadata('markup') || [];\n        resize = item.getMetadata('resize');\n        dirty = true;\n      }\n\n      // append image presenter\n      var imageView = root.appendChildView(\n        root.createChildView(ImageView, {\n          id: id,\n          image: image,\n          crop: crop,\n          resize: resize,\n          markup: markup,\n          dirty: dirty,\n          background: background,\n          opacity: 0,\n          scaleX: 1.15,\n          scaleY: 1.15,\n          translateY: 15\n        }),\n\n        root.childViews.length\n      );\n\n      root.ref.images.push(imageView);\n\n      // reveal the preview image\n      imageView.opacity = 1;\n      imageView.scaleX = 1;\n      imageView.scaleY = 1;\n      imageView.translateY = 0;\n\n      // the preview is now ready to be drawn\n      setTimeout(function() {\n        root.dispatch('DID_IMAGE_PREVIEW_SHOW', { id: id });\n      }, 250);\n    };\n\n    var updateImage = function updateImage(_ref3) {\n      var root = _ref3.root,\n        props = _ref3.props;\n      var item = root.query('GET_ITEM', { id: props.id });\n      if (!item) return;\n      var imageView = root.ref.images[root.ref.images.length - 1];\n      imageView.crop = item.getMetadata('crop');\n      imageView.background = root.query(\n        'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n      );\n\n      if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n        imageView.dirty = true;\n        imageView.resize = item.getMetadata('resize');\n        imageView.markup = item.getMetadata('markup');\n      }\n    };\n\n    // replace image preview\n    var didUpdateItemMetadata = function didUpdateItemMetadata(_ref4) {\n      var root = _ref4.root,\n        props = _ref4.props,\n        action = _ref4.action;\n      // only filter and crop trigger redraw\n      if (!/crop|filter|markup|resize/.test(action.change.key)) return;\n\n      // no images to update, exit\n      if (!root.ref.images.length) return;\n\n      // no item found, exit\n      var item = root.query('GET_ITEM', { id: props.id });\n      if (!item) return;\n\n      // for now, update existing image when filtering\n      if (/filter/.test(action.change.key)) {\n        var imageView = root.ref.images[root.ref.images.length - 1];\n        applyFilter(root, action.change.value, imageView.image);\n        return;\n      }\n\n      if (/crop|markup|resize/.test(action.change.key)) {\n        var crop = item.getMetadata('crop');\n        var image = root.ref.images[root.ref.images.length - 1];\n\n        // if aspect ratio has changed, we need to create a new image\n        if (\n          crop &&\n          crop.aspectRatio &&\n          image.crop &&\n          image.crop.aspectRatio &&\n          Math.abs(crop.aspectRatio - image.crop.aspectRatio) > 0.00001\n        ) {\n          var _imageView = shiftImage({ root: root });\n          pushImage({\n            root: root,\n            props: props,\n            image: cloneCanvas(_imageView.image)\n          });\n        }\n        // if not, we can update the current image\n        else {\n          updateImage({ root: root, props: props });\n        }\n      }\n    };\n\n    var canCreateImageBitmap = function canCreateImageBitmap(file) {\n      // Firefox versions before 58 will freeze when running createImageBitmap\n      // in a Web Worker so we detect those versions and return false for support\n      var userAgent = window.navigator.userAgent;\n      var isFirefox = userAgent.match(/Firefox\\/([0-9]+)\\./);\n      var firefoxVersion = isFirefox ? parseInt(isFirefox[1]) : null;\n      if (firefoxVersion <= 58) return false;\n\n      return 'createImageBitmap' in window && isBitmap(file);\n    };\n\n    /**\n     * Write handler for when preview container has been created\n     */\n    var didCreatePreviewContainer = function didCreatePreviewContainer(_ref5) {\n      var root = _ref5.root,\n        props = _ref5.props;\n      var id = props.id;\n\n      // we need to get the file data to determine the eventual image size\n      var item = root.query('GET_ITEM', id);\n      if (!item) return;\n\n      // get url to file (we'll revoke it later on when done)\n      var fileURL = URL.createObjectURL(item.file);\n\n      // determine image size of this item\n      getImageSize(fileURL, function(width, height) {\n        // we can now scale the panel to the final size\n        root.dispatch('DID_IMAGE_PREVIEW_CALCULATE_SIZE', {\n          id: id,\n          width: width,\n          height: height\n        });\n      });\n    };\n\n    var drawPreview = function drawPreview(_ref6) {\n      var root = _ref6.root,\n        props = _ref6.props;\n      var id = props.id;\n\n      // we need to get the file data to determine the eventual image size\n      var item = root.query('GET_ITEM', id);\n      if (!item) return;\n\n      // get url to file (we'll revoke it later on when done)\n      var fileURL = URL.createObjectURL(item.file);\n\n      // fallback\n      var loadPreviewFallback = function loadPreviewFallback() {\n        // let's scale the image in the main thread :(\n        loadImage(fileURL).then(previewImageLoaded);\n      };\n\n      // image is now ready\n      var previewImageLoaded = function previewImageLoaded(imageData) {\n        // the file url is no longer needed\n        URL.revokeObjectURL(fileURL);\n\n        // draw the scaled down version here and use that as source so bitmapdata can be closed\n        // orientation info\n        var exif = item.getMetadata('exif') || {};\n        var orientation = exif.orientation || -1;\n\n        // get width and height from action, and swap if orientation is incorrect\n        var width = imageData.width,\n          height = imageData.height;\n\n        // if no width or height, just return early.\n        if (!width || !height) return;\n\n        if (orientation >= 5 && orientation <= 8) {\n          var _ref7 = [height, width];\n          width = _ref7[0];\n          height = _ref7[1];\n        }\n\n        // scale canvas based on pixel density\n        // we multiply by .75 as that creates smaller but still clear images on screens with high res displays\n        var pixelDensityFactor = Math.max(1, window.devicePixelRatio * 0.75);\n\n        // we want as much pixels to work with as possible,\n        // this multiplies the minimum image resolution,\n        // so when zooming in it doesn't get too blurry\n        var zoomFactor = root.query('GET_IMAGE_PREVIEW_ZOOM_FACTOR');\n\n        // imaeg scale factor\n        var scaleFactor = zoomFactor * pixelDensityFactor;\n\n        // calculate scaled preview image size\n        var previewImageRatio = height / width;\n\n        // calculate image preview height and width\n        var previewContainerWidth = root.rect.element.width;\n        var previewContainerHeight = root.rect.element.height;\n\n        var imageWidth = previewContainerWidth;\n        var imageHeight = imageWidth * previewImageRatio;\n\n        if (previewImageRatio > 1) {\n          imageWidth = Math.min(width, previewContainerWidth * scaleFactor);\n          imageHeight = imageWidth * previewImageRatio;\n        } else {\n          imageHeight = Math.min(height, previewContainerHeight * scaleFactor);\n          imageWidth = imageHeight / previewImageRatio;\n        }\n\n        // transfer to image tag so no canvas memory wasted on iOS\n        var previewImage = createPreviewImage(\n          imageData,\n          imageWidth,\n          imageHeight,\n          orientation\n        );\n\n        // done\n        var done = function done() {\n          // calculate average image color, disabled for now\n          var averageColor = root.query(\n            'GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR'\n          )\n            ? calculateAverageColor(data)\n            : null;\n          item.setMetadata('color', averageColor, true);\n\n          // data has been transferred to canvas ( if was ImageBitmap )\n          if ('close' in imageData) {\n            imageData.close();\n          }\n\n          // show the overlay\n          root.ref.overlayShadow.opacity = 1;\n\n          // create the first image\n          pushImage({ root: root, props: props, image: previewImage });\n        };\n\n        // apply filter\n        var filter = item.getMetadata('filter');\n        if (filter) {\n          applyFilter(root, filter, previewImage).then(done);\n        } else {\n          done();\n        }\n      };\n\n      // if we support scaling using createImageBitmap we use a worker\n      if (canCreateImageBitmap(item.file)) {\n        // let's scale the image in a worker\n        var worker = createWorker(BitmapWorker);\n\n        worker.post(\n          {\n            file: item.file\n          },\n\n          function(imageBitmap) {\n            // destroy worker\n            worker.terminate();\n\n            // no bitmap returned, must be something wrong,\n            // try the oldschool way\n            if (!imageBitmap) {\n              loadPreviewFallback();\n              return;\n            }\n\n            // yay we got our bitmap, let's continue showing the preview\n            previewImageLoaded(imageBitmap);\n          }\n        );\n      } else {\n        // create fallback preview\n        loadPreviewFallback();\n      }\n    };\n\n    /**\n     * Write handler for when the preview image is ready to be animated\n     */\n    var didDrawPreview = function didDrawPreview(_ref8) {\n      var root = _ref8.root;\n      // get last added image\n      var image = root.ref.images[root.ref.images.length - 1];\n      image.translateY = 0;\n      image.scaleX = 1.0;\n      image.scaleY = 1.0;\n      image.opacity = 1;\n    };\n\n    /**\n     * Write handler for when the preview has been loaded\n     */\n    var restoreOverlay = function restoreOverlay(_ref9) {\n      var root = _ref9.root;\n      root.ref.overlayShadow.opacity = 1;\n      root.ref.overlayError.opacity = 0;\n      root.ref.overlaySuccess.opacity = 0;\n    };\n\n    var didThrowError = function didThrowError(_ref10) {\n      var root = _ref10.root;\n      root.ref.overlayShadow.opacity = 0.25;\n      root.ref.overlayError.opacity = 1;\n    };\n\n    var didCompleteProcessing = function didCompleteProcessing(_ref11) {\n      var root = _ref11.root;\n      root.ref.overlayShadow.opacity = 0.25;\n      root.ref.overlaySuccess.opacity = 1;\n    };\n\n    /**\n     * Constructor\n     */\n    var create = function create(_ref12) {\n      var root = _ref12.root;\n      // image view\n      root.ref.images = [];\n\n      // the preview image data (we need this to filter the image)\n      root.ref.imageData = null;\n\n      // image bin\n      root.ref.imageViewBin = [];\n\n      // image overlays\n      root.ref.overlayShadow = root.appendChildView(\n        root.createChildView(OverlayView, {\n          opacity: 0,\n          status: 'idle'\n        })\n      );\n\n      root.ref.overlaySuccess = root.appendChildView(\n        root.createChildView(OverlayView, {\n          opacity: 0,\n          status: 'success'\n        })\n      );\n\n      root.ref.overlayError = root.appendChildView(\n        root.createChildView(OverlayView, {\n          opacity: 0,\n          status: 'failure'\n        })\n      );\n    };\n\n    return _.utils.createView({\n      name: 'image-preview-wrapper',\n      create: create,\n      styles: ['height'],\n      apis: ['height'],\n      destroy: function destroy(_ref13) {\n        var root = _ref13.root;\n        // we resize the image so memory on iOS 12 is released more quickly (it seems)\n        root.ref.images.forEach(function(imageView) {\n          imageView.image.width = 1;\n          imageView.image.height = 1;\n        });\n      },\n      didWriteView: function didWriteView(_ref14) {\n        var root = _ref14.root;\n        root.ref.images.forEach(function(imageView) {\n          imageView.dirty = false;\n        });\n      },\n      write: _.utils.createRoute(\n        {\n          // image preview stated\n          DID_IMAGE_PREVIEW_DRAW: didDrawPreview,\n          DID_IMAGE_PREVIEW_CONTAINER_CREATE: didCreatePreviewContainer,\n          DID_FINISH_CALCULATE_PREVIEWSIZE: drawPreview,\n          DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata,\n\n          // file states\n          DID_THROW_ITEM_LOAD_ERROR: didThrowError,\n          DID_THROW_ITEM_PROCESSING_ERROR: didThrowError,\n          DID_THROW_ITEM_INVALID: didThrowError,\n          DID_COMPLETE_ITEM_PROCESSING: didCompleteProcessing,\n          DID_START_ITEM_PROCESSING: restoreOverlay,\n          DID_REVERT_ITEM_PROCESSING: restoreOverlay\n        },\n\n        function(_ref15) {\n          var root = _ref15.root;\n          // views on death row\n          var viewsToRemove = root.ref.imageViewBin.filter(function(imageView) {\n            return imageView.opacity === 0;\n          });\n\n          // views to retain\n          root.ref.imageViewBin = root.ref.imageViewBin.filter(function(\n            imageView\n          ) {\n            return imageView.opacity > 0;\n          });\n\n          // remove these views\n          viewsToRemove.forEach(function(imageView) {\n            return removeImageView(root, imageView);\n          });\n          viewsToRemove.length = 0;\n        }\n      )\n    });\n  };\n\n  /**\n   * Image Preview Plugin\n   */\n  var plugin = function plugin(fpAPI) {\n    var addFilter = fpAPI.addFilter,\n      utils = fpAPI.utils;\n    var Type = utils.Type,\n      createRoute = utils.createRoute,\n      isFile = utils.isFile;\n\n    // imagePreviewView\n    var imagePreviewView = createImageWrapperView(fpAPI);\n\n    // called for each view that is created right after the 'create' method\n    addFilter('CREATE_VIEW', function(viewAPI) {\n      // get reference to created view\n      var is = viewAPI.is,\n        view = viewAPI.view,\n        query = viewAPI.query;\n\n      // only hook up to item view and only if is enabled for this cropper\n      if (!is('file') || !query('GET_ALLOW_IMAGE_PREVIEW')) return;\n\n      // create the image preview plugin, but only do so if the item is an image\n      var didLoadItem = function didLoadItem(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        var id = props.id;\n        var item = query('GET_ITEM', id);\n\n        // item could theoretically have been removed in the mean time\n        if (!item || !isFile(item.file) || item.archived) return;\n\n        // get the file object\n        var file = item.file;\n\n        // exit if this is not an image\n        if (!isPreviewableImage(file)) return;\n\n        // test if is filtered\n        if (!query('GET_IMAGE_PREVIEW_FILTER_ITEM')(item)) return;\n\n        // exit if image size is too high and no createImageBitmap support\n        // this would simply bring the browser to its knees and that is not what we want\n        var supportsCreateImageBitmap = 'createImageBitmap' in (window || {});\n        var maxPreviewFileSize = query('GET_IMAGE_PREVIEW_MAX_FILE_SIZE');\n        if (\n          !supportsCreateImageBitmap &&\n          maxPreviewFileSize &&\n          file.size > maxPreviewFileSize\n        )\n          return;\n\n        // set preview view\n        root.ref.imagePreview = view.appendChildView(\n          view.createChildView(imagePreviewView, { id: id })\n        );\n\n        // update height if is fixed\n        var fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        if (fixedPreviewHeight) {\n          root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n            id: item.id,\n            height: fixedPreviewHeight\n          });\n        }\n\n        // now ready\n        var queue =\n          !supportsCreateImageBitmap &&\n          file.size > query('GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE');\n        root.dispatch('DID_IMAGE_PREVIEW_CONTAINER_CREATE', { id: id }, queue);\n      };\n\n      var rescaleItem = function rescaleItem(root, props) {\n        if (!root.ref.imagePreview) return;\n        var id = props.id;\n\n        // get item\n        var item = root.query('GET_ITEM', { id: id });\n        if (!item) return;\n\n        // if is fixed height or panel has aspect ratio, exit here, height has already been defined\n        var panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n        var itemPanelAspectRatio = root.query('GET_ITEM_PANEL_ASPECT_RATIO');\n        var fixedHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        if (panelAspectRatio || itemPanelAspectRatio || fixedHeight) return;\n\n        // no data!\n        var _root$ref = root.ref,\n          imageWidth = _root$ref.imageWidth,\n          imageHeight = _root$ref.imageHeight;\n        if (!imageWidth || !imageHeight) return;\n\n        // get height min and max\n        var minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n        var maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n\n        // orientation info\n        var exif = item.getMetadata('exif') || {};\n        var orientation = exif.orientation || -1;\n\n        // get width and height from action, and swap of orientation is incorrect\n        if (orientation >= 5 && orientation <= 8) {\n          var _ref2 = [imageHeight, imageWidth];\n          imageWidth = _ref2[0];\n          imageHeight = _ref2[1];\n        }\n\n        // scale up width and height when we're dealing with an SVG\n        if (!isBitmap(item.file) || root.query('GET_IMAGE_PREVIEW_UPSCALE')) {\n          var scalar = 2048 / imageWidth;\n          imageWidth *= scalar;\n          imageHeight *= scalar;\n        }\n\n        // image aspect ratio\n        var imageAspectRatio = imageHeight / imageWidth;\n\n        // we need the item to get to the crop size\n        var previewAspectRatio =\n          (item.getMetadata('crop') || {}).aspectRatio || imageAspectRatio;\n\n        // preview height range\n        var previewHeightMax = Math.max(\n          minPreviewHeight,\n          Math.min(imageHeight, maxPreviewHeight)\n        );\n\n        var itemWidth = root.rect.element.width;\n        var previewHeight = Math.min(\n          itemWidth * previewAspectRatio,\n          previewHeightMax\n        );\n\n        // request update to panel height\n        root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n          id: item.id,\n          height: previewHeight\n        });\n      };\n\n      var didResizeView = function didResizeView(_ref3) {\n        var root = _ref3.root;\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n      };\n\n      var didUpdateItemMetadata = function didUpdateItemMetadata(_ref4) {\n        var root = _ref4.root,\n          action = _ref4.action;\n        if (action.change.key !== 'crop') return;\n\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n      };\n\n      var didCalculatePreviewSize = function didCalculatePreviewSize(_ref5) {\n        var root = _ref5.root,\n          action = _ref5.action;\n        // remember dimensions\n        root.ref.imageWidth = action.width;\n        root.ref.imageHeight = action.height;\n\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n        root.ref.shouldDrawPreview = true;\n\n        // as image load could take a while and fire when draw loop is resting we need to give it a kick\n        root.dispatch('KICK');\n      };\n\n      // start writing\n      view.registerWriter(\n        createRoute(\n          {\n            DID_RESIZE_ROOT: didResizeView,\n            DID_STOP_RESIZE: didResizeView,\n            DID_LOAD_ITEM: didLoadItem,\n            DID_IMAGE_PREVIEW_CALCULATE_SIZE: didCalculatePreviewSize,\n            DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata\n          },\n\n          function(_ref6) {\n            var root = _ref6.root,\n              props = _ref6.props;\n            // no preview view attached\n            if (!root.ref.imagePreview) return;\n\n            // don't do anything while hidden\n            if (root.rect.element.hidden) return;\n\n            // resize the item panel\n            if (root.ref.shouldRescale) {\n              rescaleItem(root, props);\n              root.ref.shouldRescale = false;\n            }\n\n            if (root.ref.shouldDrawPreview) {\n              // queue till next frame so we're sure the height has been applied this forces the draw image call inside the wrapper view to use the correct height\n              requestAnimationFrame(function() {\n                // this requestAnimationFrame nesting is horrible but it fixes an issue with 100hz displays on Chrome\n                // https://github.com/pqina/filepond-plugin-image-preview/issues/57\n                requestAnimationFrame(function() {\n                  root.dispatch('DID_FINISH_CALCULATE_PREVIEWSIZE', {\n                    id: props.id\n                  });\n                });\n              });\n\n              root.ref.shouldDrawPreview = false;\n            }\n          }\n        )\n      );\n    });\n\n    // expose plugin\n    return {\n      options: {\n        // Enable or disable image preview\n        allowImagePreview: [true, Type.BOOLEAN],\n\n        // filters file items to determine which are shown as preview\n        imagePreviewFilterItem: [\n          function() {\n            return true;\n          },\n          Type.FUNCTION\n        ],\n\n        // Fixed preview height\n        imagePreviewHeight: [null, Type.INT],\n\n        // Min image height\n        imagePreviewMinHeight: [44, Type.INT],\n\n        // Max image height\n        imagePreviewMaxHeight: [256, Type.INT],\n\n        // Max size of preview file for when createImageBitmap is not supported\n        imagePreviewMaxFileSize: [null, Type.INT],\n\n        // The amount of extra pixels added to the image preview to allow comfortable zooming\n        imagePreviewZoomFactor: [2, Type.INT],\n\n        // Should we upscale small images to fit the max bounding box of the preview area\n        imagePreviewUpscale: [false, Type.BOOLEAN],\n\n        // Max size of preview file that we allow to try to instant preview if createImageBitmap is not supported, else image is queued for loading\n        imagePreviewMaxInstantPreviewFileSize: [1000000, Type.INT],\n\n        // Style of the transparancy indicator used behind images\n        imagePreviewTransparencyIndicator: [null, Type.STRING],\n\n        // Enables or disables reading average image color\n        imagePreviewCalculateAverageImageColor: [false, Type.BOOLEAN],\n\n        // Enables or disables the previewing of markup\n        imagePreviewMarkupShow: [true, Type.BOOLEAN],\n\n        // Allows filtering of markup to only show certain shapes\n        imagePreviewMarkupFilter: [\n          function() {\n            return true;\n          },\n          Type.FUNCTION\n        ]\n      }\n    };\n  };\n\n  // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n  var isBrowser =\n    typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  if (isBrowser) {\n    document.dispatchEvent(\n      new CustomEvent('FilePond:pluginloaded', { detail: plugin })\n    );\n  }\n\n  return plugin;\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}